<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Executive Admissions Dashboard</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background-color: #f0f2f5;
            color: #1a1a1a;
            line-height: 1.6;
        }
        
        .dashboard-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 1rem;
        }
        
        /* Header */
        .dashboard-header {
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            margin-bottom: 1rem;
        }
        
        .header-content {
            text-align: center;
        }
        
        .header-title h1 {
            font-size: 1.75rem;
            font-weight: 700;
            color: #1a1a1a;
            margin-bottom: 0.25rem;
        }
        
        .header-subtitle {
            color: #6b7280;
            font-size: 0.95rem;
        }
        
        /* Executive Summary */
        .executive-summary {
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            margin-bottom: 1.5rem;
        }
        
        .summary-title {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
            color: #1a1a1a;
        }
        
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
        }
        
        .summary-card {
            background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
            padding: 1.5rem;
            border-radius: 10px;
            border: 1px solid #e5e7eb;
            text-align: center;
        }
        
        .summary-label {
            font-size: 0.875rem;
            color: #6b7280;
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .summary-value {
            font-size: 2.5rem;
            font-weight: 700;
            line-height: 1.2;
            margin-bottom: 0.5rem;
        }
        
        .summary-value.positive { color: #10b981; }
        .summary-value.negative { color: #ef4444; }
        .summary-value.warning { color: #f59e0b; }
        
        .summary-detail {
            font-size: 0.875rem;
            color: #6b7280;
        }
        
        /* Cycle Progress Bar */
        .cycle-progress-section {
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            margin-bottom: 1.5rem;
        }
        
        .cycle-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            flex-wrap: wrap;
            gap: 1rem;
        }
        
        .cycle-header h2 {
            font-size: 1.125rem;
            font-weight: 600;
            margin: 0;
        }
        
        .cycle-stats {
            display: flex;
            gap: 0.75rem;
            align-items: center;
            font-size: 0.95rem;
        }
        
        .cycle-stat {
            color: #4b5563;
        }
        
        .progress-bar-container {
            background: #e5e7eb;
            height: 32px;
            border-radius: 16px;
            overflow: hidden;
            position: relative;
            margin-bottom: 0.75rem;
        }
        
        .progress-bar-fill {
            background: linear-gradient(90deg, #3b82f6 0%, #2563eb 100%);
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 1rem;
            transition: width 0.3s ease;
        }
        
        .progress-label {
            color: white;
            font-weight: 600;
            font-size: 0.875rem;
        }
        
        .cycle-dates {
            display: flex;
            justify-content: space-between;
            font-size: 0.875rem;
            color: #6b7280;
        }
        
        /* Daily Changes Section */
        .daily-changes-section {
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            margin-bottom: 1.5rem;
        }
        
        .daily-changes-title {
            font-size: 1.125rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
            color: #1a1a1a;
        }
        
        .changes-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
        }
        
        .change-card {
            background: #f8f9fa;
            padding: 1.5rem;
            border-radius: 10px;
            border: 1px solid #e5e7eb;
        }
        
        .change-card.highlight {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            border-color: #fbbf24;
        }
        
        .change-header {
            display: flex;
            justify-content: space-between;
            align-items: baseline;
            margin-bottom: 0.75rem;
        }
        
        .change-label {
            font-size: 0.875rem;
            color: #6b7280;
            font-weight: 500;
        }
        
        .change-value {
            font-size: 1.75rem;
            font-weight: 700;
            color: #1a1a1a;
        }
        
        .change-value.positive {
            color: #10b981;
        }
        
        .change-value.negative {
            color: #ef4444;
        }
        
        .change-detail {
            font-size: 0.875rem;
            color: #6b7280;
            margin-bottom: 0.5rem;
        }
        
        .change-breakdown {
            font-size: 0.75rem;
            color: #6b7280;
            margin-top: 0.75rem;
            padding-top: 0.75rem;
            border-top: 1px solid #e5e7eb;
        }
        
        .change-chart {
            margin-top: 0.75rem;
            height: 50px;
            padding: 0 0.5rem;
        }
        
        /* Milestone Section */
        .milestone-section {
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            margin-bottom: 1.5rem;
        }
        
        .milestone-title {
            font-size: 1.125rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
            color: #1a1a1a;
        }
        
        .milestone-container {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 2rem;
        }
        
        .next-milestone-card {
            background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%);
            padding: 1.5rem;
            border-radius: 12px;
            border: 1px solid #bfdbfe;
        }
        
        .milestone-header {
            display: flex;
            justify-content: space-between;
            align-items: baseline;
            margin-bottom: 0.75rem;
        }
        
        .milestone-label {
            font-size: 0.875rem;
            color: #1e40af;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .milestone-value {
            font-size: 2rem;
            font-weight: 700;
            color: #1e40af;
        }
        
        .milestone-detail {
            font-size: 0.875rem;
            color: #3730a3;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .milestone-separator {
            color: #60a5fa;
        }
        
        .milestone-progress-bar {
            background: #dbeafe;
            height: 24px;
            border-radius: 12px;
            overflow: hidden;
            position: relative;
        }
        
        .milestone-progress-fill {
            background: linear-gradient(90deg, #3b82f6 0%, #2563eb 100%);
            height: 100%;
            transition: width 0.5s ease;
        }
        
        .milestone-progress-label {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 0.75rem;
            font-weight: 600;
            color: white;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
        }
        
        .all-milestones {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 1rem;
        }
        
        .milestone-item {
            background: #f8f9fa;
            padding: 1rem;
            border-radius: 8px;
            border: 1px solid #e5e7eb;
            text-align: center;
        }
        
        .milestone-item.final {
            background: #fef3c7;
            border-color: #fde68a;
        }
        
        .milestone-item-header {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            margin-bottom: 0.75rem;
        }
        
        .milestone-item-header span:first-child {
            font-weight: 700;
            font-size: 1rem;
            color: #1a1a1a;
        }
        
        .milestone-status {
            font-size: 0.75rem;
            color: #6b7280;
        }
        
        .milestone-status.achieved {
            color: #10b981;
            font-weight: 600;
        }
        
        .milestone-mini-progress {
            background: #e5e7eb;
            height: 6px;
            border-radius: 3px;
            overflow: hidden;
        }
        
        .milestone-mini-fill {
            background: #10b981;
            height: 100%;
            transition: width 0.5s ease;
        }
        
        .milestone-mini-fill.partial {
            background: #3b82f6;
        }
        
        @media (max-width: 1024px) {
            .milestone-container {
                grid-template-columns: 1fr;
            }
            
            .all-milestones {
                grid-template-columns: repeat(3, 1fr);
            }
        }
        
        @media (max-width: 768px) {
            .all-milestones {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        /* Registration Focus Section */
        .registration-focus-section {
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            margin-bottom: 1.5rem;
        }
        
        .registration-title {
            font-size: 1.125rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
            color: #1a1a1a;
        }
        
        .registration-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1.5rem;
        }
        
        .registration-main-card {
            background: white;
            padding: 1.5rem;
            padding-bottom: 0.5rem;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }
        
        .registration-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1.5rem;
        }
        
        .registration-label {
            font-size: 0.875rem;
            color: #991b1b;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 0.5rem;
            margin-top: 2rem;
        }
        
        .registration-value {
            font-size: 3rem;
            font-weight: 700;
            color: #dc2626;
            line-height: 1;
        }
        
        .registration-rate-display {
            text-align: center;
            background: white;
            padding: 1rem 1.5rem;
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .rate-value {
            font-size: 2rem;
            font-weight: 700;
            color: #dc2626;
        }
        
        .rate-label {
            font-size: 0.75rem;
            color: #991b1b;
            margin-top: 0.25rem;
        }
        
        .registration-comparison {
            display: flex;
            gap: 2rem;
            margin-bottom: 1.5rem;
        }
        
        .comparison-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .comparison-label {
            font-size: 0.875rem;
            color: #15803d;
        }
        
        .comparison-value {
            font-weight: 600;
            font-size: 0.95rem;
        }
        
        .comparison-value.positive {
            color: #166534;
        }
        
        .comparison-value.negative {
            color: #dc2626;
        }
        
        .registration-chart-container {
            height: 280px;
            margin-top: 2rem;
            margin-bottom: -0.5rem;
            margin-left: -1.5rem;
            margin-right: -1.5rem;
        }
        
        .registration-insights {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            margin-top: 1rem;
        }
        
        .insight-card {
            background: #f8f9fa;
            padding: 1.25rem;
            border-radius: 10px;
            border: 1px solid #e5e7eb;
        }
        
        .insight-header {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.75rem;
        }
        
        .insight-icon {
            font-size: 1.25rem;
        }
        
        .insight-label {
            font-size: 0.875rem;
            color: #6b7280;
            font-weight: 500;
        }
        
        .insight-value {
            font-size: 1.75rem;
            font-weight: 700;
            color: #1a1a1a;
            margin-bottom: 0.25rem;
        }
        
        .insight-detail {
            font-size: 0.75rem;
            color: #6b7280;
            margin-bottom: 0.5rem;
        }
        
        .insight-progress {
            background: #e5e7eb;
            height: 8px;
            border-radius: 4px;
            overflow: hidden;
        }
        
        .insight-progress-fill {
            background: #10b981;
            height: 100%;
            transition: width 0.5s ease;
        }
        
        .campus-conversion-list {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            font-size: 0.875rem;
        }
        
        .campus-conversion-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .campus-conversion-rate {
            font-weight: 600;
            color: #166534;
        }
        
        @media (max-width: 1024px) {
            .registration-insights {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (max-width: 768px) {
            .registration-insights {
                grid-template-columns: 1fr;
            }
            
            .registration-chart-container {
                height: 200px;
            }
        }
        
        /* KPI Section */
        .kpi-section {
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            margin-bottom: 1.5rem;
        }
        
        .kpi-title {
            font-size: 1.125rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
        }
        
        .kpi-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
        }
        
        .kpi-card {
            display: flex;
            align-items: center;
            background: #f8f9fa;
            padding: 1.25rem;
            border-radius: 10px;
            gap: 1rem;
        }
        
        .kpi-icon {
            font-size: 2rem;
            opacity: 0.8;
        }
        
        .kpi-content {
            flex: 1;
        }
        
        .kpi-label {
            font-size: 0.875rem;
            color: #6b7280;
            margin-bottom: 0.25rem;
        }
        
        .kpi-value {
            font-size: 1.5rem;
            font-weight: 700;
            line-height: 1.2;
        }
        
        .kpi-trend {
            font-size: 0.75rem;
            margin-top: 0.25rem;
        }
        
        .kpi-trend.positive { color: #10b981; }
        .kpi-trend.negative { color: #ef4444; }
        
        /* Alerts Section */
        .alerts-section {
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            margin-bottom: 1.5rem;
        }
        
        .alerts-header {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }
        
        .alert-icon {
            width: 24px;
            height: 24px;
            background: #ef4444;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 14px;
        }
        
        .alerts-title {
            font-size: 1.125rem;
            font-weight: 600;
        }
        
        .alert-item {
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
            padding: 0.75rem 0;
            border-bottom: 1px solid #f3f4f6;
        }
        
        .alert-item:last-child {
            border-bottom: none;
        }
        
        .alert-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-top: 0.5rem;
            flex-shrink: 0;
        }
        
        .alert-indicator.high { background: #ef4444; }
        .alert-indicator.warning { background: #f59e0b; }
        .alert-indicator.positive { background: #10b981; }
        .alert-indicator.info { background: #3b82f6; }
        
        .alert-content {
            flex: 1;
        }
        
        .alert-message {
            font-size: 0.95rem;
            margin-bottom: 0.25rem;
        }
        
        .alert-detail {
            font-size: 0.875rem;
            color: #6b7280;
        }
        
        /* Key Metrics Section */
        .metrics-section {
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            margin-bottom: 1.5rem;
        }
        
        /* Divider styles */
        .section-divider {
            height: 1px;
            background: linear-gradient(to right, transparent, #e5e7eb 20%, #e5e7eb 80%, transparent);
            margin: 2rem 0;
        }
        
        .chart-divider {
            height: 1px;
            background: #e5e7eb;
            margin: 2rem 0;
            position: relative;
        }
        
        .expandable-content .chart-divider {
            margin: 2rem 0;
        }
        
        .metrics-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }
        
        .metrics-title {
            font-size: 1.125rem;
            font-weight: 600;
        }
        
        .view-toggle {
            display: flex;
            background: #f3f4f6;
            border-radius: 8px;
            padding: 0.25rem;
        }
        
        .view-toggle button {
            padding: 0.5rem 1rem;
            border: none;
            background: transparent;
            color: #6b7280;
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            border-radius: 6px;
            transition: all 0.2s;
        }
        
        .view-toggle button.active {
            background: white;
            color: #1a1a1a;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
        }
        
        .metric-card {
            padding: 1.25rem;
            border-radius: 10px;
            background: #f8f9fa;
            position: relative;
            overflow: hidden;
        }
        
        .metric-card.below-target {
            background: #fef3c7;
            border: 1px solid #fde68a;
        }
        
        .metric-card.warning {
            background: #fef3c7;
            border: 1px solid #fde68a;
        }
        
        .metric-card.positive {
            background: #d1fae5;
            border: 1px solid #a7f3d0;
        }
        
        .metric-label {
            font-size: 0.875rem;
            color: #6b7280;
            margin-bottom: 0.5rem;
        }
        
        .metric-value {
            font-size: 2rem;
            font-weight: 700;
            line-height: 1.2;
            margin-bottom: 0.5rem;
        }
        
        .metric-change {
            font-size: 0.875rem;
            font-weight: 500;
        }
        
        .metric-change.positive { color: #10b981; }
        .metric-change.negative { color: #ef4444; }
        
        .metric-spark {
            position: absolute;
            bottom: 0;
            right: 0;
            opacity: 0.3;
        }
        
        /* Expandable Sections */
        .expandable-section {
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            margin-bottom: 1.5rem;
            overflow: hidden;
        }
        
        .expandable-header {
            padding: 1.5rem;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background-color 0.2s;
        }
        
        .expandable-header:hover {
            background-color: #f8f9fa;
        }
        
        .expandable-title {
            font-size: 1.125rem;
            font-weight: 600;
        }
        
        .expand-icon {
            width: 24px;
            height: 24px;
            transition: transform 0.3s;
        }
        
        .expandable-header.expanded .expand-icon {
            transform: rotate(180deg);
        }
        
        .expandable-content {
            padding: 0 1.5rem;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out, padding 0.3s ease-out;
        }
        
        .expandable-content.expanded {
            max-height: 2000px;
            padding: 0 1.5rem 1.5rem 1.5rem;
        }
        
        /* Charts */
        .chart-container {
            position: relative;
            height: 300px;
            margin: 1rem 0;
        }
        
        .chart-container.small {
            height: 200px;
        }
        
        /* Tables */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
        }
        
        .data-table th {
            background: #f8f9fa;
            padding: 0.75rem;
            text-align: left;
            font-weight: 600;
            font-size: 0.875rem;
            border-bottom: 2px solid #e5e7eb;
        }
        
        .data-table td {
            padding: 0.75rem;
            border-bottom: 1px solid #f3f4f6;
            font-size: 0.875rem;
        }
        
        .data-table tr:hover {
            background: #f8f9fa;
        }
        
        /* Performance Badges */
        .performance-badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 16px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .performance-low {
            background: #fef3c7;
            color: #92400e;
            border: 1px solid #fde68a;
        }
        
        .performance-warning {
            background: #fef3c7;
            color: #d97706;
            border: 1px solid #fde68a;
        }
        
        .performance-good {
            background: #d1fae5;
            color: #059669;
            border: 1px solid #a7f3d0;
        }
        
        .performance-neutral {
            background: #f3f4f6;
            color: #6b7280;
            border: 1px solid #e5e7eb;
        }
        
        /* Utility Classes */
        .text-positive { color: #10b981; }
        .text-negative { color: #ef4444; }
        .text-muted { color: #6b7280; }
        
        /* Mobile Responsive */
        @media (max-width: 768px) {
            .dashboard-container {
                padding: 0.5rem;
            }
            
            .header-content {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .metrics-grid {
                grid-template-columns: 1fr;
            }
            
            .view-toggle {
                flex-wrap: wrap;
            }
            
            .view-toggle button {
                flex: 1;
                min-width: 80px;
            }
        }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <!-- Header -->
        <div class="dashboard-header">
            <div class="header-content">
                <div class="header-title">
                    <h1>Executive Admissions Dashboard</h1>
                    <div class="header-subtitle">Fall 2025-2026 Admissions Cycle ‚Ä¢ Last updated: August 01, 2025 at 08:48 AM</div>
                </div>
            </div>
        </div>
        
        <!-- Executive Summary -->
        <div class="executive-summary">
            <h2 class="summary-title">Executive Summary</h2>
            <div class="summary-grid">
                <div class="summary-card">
                    <div class="summary-label">Target Achievement</div>
                    <div class="summary-value" id="targetAchievement">--</div>
                    <div class="summary-detail" id="targetDetail">--</div>
                </div>
                <div class="summary-card">
                    <div class="summary-label">Projected Total</div>
                    <div class="summary-value" id="projectedTotal">--</div>
                    <div class="summary-detail" id="projectedDetail">--</div>
                </div>
                <div class="summary-card">
                    <div class="summary-label">YoY Performance</div>
                    <div class="summary-value" id="yoyPerformance">--</div>
                    <div class="summary-detail" id="yoyDetail">--</div>
                </div>
                <div class="summary-card">
                    <div class="summary-label">Required Daily Rate</div>
                    <div class="summary-value" id="requiredRate">--</div>
                    <div class="summary-detail" id="currentRate">--</div>
                </div>
            </div>
        </div>
        
        <!-- Cycle Progress Bar -->
        <div class="cycle-progress-section">
            <div class="cycle-header">
                <h2>Admission Cycle Progress</h2>
                <div class="cycle-stats">
                    <span class="cycle-stat"><strong>Day 47</strong> of 139</span>
                    <span class="cycle-stat">‚Ä¢</span>
                    <span class="cycle-stat"><strong>33.8%</strong> Complete</span>
                    <span class="cycle-stat">‚Ä¢</span>
                    <span class="cycle-stat"><strong>92 days</strong> Remaining</span>
                </div>
            </div>
            <div class="progress-bar-container">
                <div class="progress-bar-fill" style="width: 33.8%">
                    <span class="progress-label">33.8%</span>
                </div>
            </div>
            <div class="cycle-dates">
                <span>Start: June 15</span>
                <span>Current: 7/31 (Day 47)</span>
                <span>End: October 31 (Day 139)</span>
            </div>
        </div>
        
        <div class="section-divider"></div>
        
        <!-- What Changed Since Yesterday -->
        <div class="daily-changes-section">
            <h2 class="daily-changes-title">What Changed Since Yesterday</h2>
            <div class="changes-grid">
                <div class="change-card">
                    <div class="change-header">
                        <span class="change-label">New Applications</span>
                        <span class="change-value" id="dailyNewApps">--</span>
                    </div>
                    <div class="change-detail" id="dailyAppDetail">--</div>
                    <div class="change-breakdown" id="campusBreakdown">--</div>
                </div>
                <div class="change-card">
                    <div class="change-header">
                        <span class="change-label">Total Progress</span>
                        <span class="change-value" id="totalProgress">--</span>
                    </div>
                    <div class="change-detail" id="progressDetail">--</div>
                    <div class="change-chart">
                        <canvas id="progressSparkline" style="width: 100%; height: 50px;"></canvas>
                    </div>
                </div>
                <div class="change-card">
                    <div class="change-header">
                        <span class="change-label">Registration Conversions</span>
                        <span class="change-value" id="newRegistrations">--</span>
                    </div>
                    <div class="change-detail" id="registrationDetail">--</div>
                    <div class="change-breakdown" id="conversionRate">--</div>
                </div>
                <div class="change-card highlight">
                    <div class="change-header">
                        <span class="change-label">Top 3 Performers</span>
                    </div>
                    <div id="topCampusesContainer" style="margin-top: 1rem;">
                        <!-- Top 3 will be populated here -->
                    </div>
                    <div class="change-breakdown" id="topCampusSummary" style="margin-top: 1rem; font-weight: 500;">--</div>
                </div>
            </div>
        </div>
        
        <div class="section-divider"></div>
        
        <!-- Milestone Tracker -->
        <div class="milestone-section">
            <h2 class="milestone-title">Applications Milestone Progress</h2>
            <div class="milestone-container">
                <div class="next-milestone-card">
                    <div class="milestone-header">
                        <span class="milestone-label">Next Milestone</span>
                        <span class="milestone-value" id="nextMilestoneValue">--</span>
                    </div>
                    <div class="milestone-detail">
                        <span id="milestoneDaysAway">--</span>
                        <span class="milestone-separator">‚Ä¢</span>
                        <span id="milestoneProjectedDate">--</span>
                    </div>
                    <div class="milestone-progress-bar">
                        <div class="milestone-progress-fill" id="nextMilestoneProgress"></div>
                        <span class="milestone-progress-label" id="nextMilestoneLabel">--</span>
                    </div>
                </div>
                <div class="all-milestones">
                    <div class="milestone-item" data-target="1200">
                        <div class="milestone-item-header">
                            <span>1,200</span>
                            <span class="milestone-status" id="milestone1200">--</span>
                        </div>
                        <div class="milestone-mini-progress">
                            <div class="milestone-mini-fill" id="progress1200"></div>
                        </div>
                    </div>
                    <div class="milestone-item" data-target="1500">
                        <div class="milestone-item-header">
                            <span>1,500</span>
                            <span class="milestone-status" id="milestone1500">--</span>
                        </div>
                        <div class="milestone-mini-progress">
                            <div class="milestone-mini-fill" id="progress1500"></div>
                        </div>
                    </div>
                    <div class="milestone-item" data-target="2000">
                        <div class="milestone-item-header">
                            <span>2,000</span>
                            <span class="milestone-status" id="milestone2000">--</span>
                        </div>
                        <div class="milestone-mini-progress">
                            <div class="milestone-mini-fill" id="progress2000"></div>
                        </div>
                    </div>
                    <div class="milestone-item" data-target="2500">
                        <div class="milestone-item-header">
                            <span>2,500</span>
                            <span class="milestone-status" id="milestone2500">--</span>
                        </div>
                        <div class="milestone-mini-progress">
                            <div class="milestone-mini-fill" id="progress2500"></div>
                        </div>
                    </div>
                    <div class="milestone-item final" data-target="2700">
                        <div class="milestone-item-header">
                            <span>2,700 üéØ</span>
                            <span class="milestone-status" id="milestone2700">--</span>
                        </div>
                        <div class="milestone-mini-progress">
                            <div class="milestone-mini-fill" id="progress2700"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="section-divider"></div>
        
        <!-- Registration Focus -->
        <div class="registration-focus-section">
            <h2 class="registration-title">Registration Performance</h2>
            <div class="registration-grid">
                <div class="registration-main-card">
                    <div class="registration-header">
                        <div>
                            <div class="registration-label">Total Registered</div>
                            <div class="registration-value" id="totalRegistered">--</div>
                        </div>
                        <div class="registration-rate-display">
                            <div class="rate-value" id="currentConversionRate">--</div>
                            <div class="rate-label">Conversion Rate</div>
                        </div>
                    </div>
                    <div class="registration-comparison">
                        <div class="comparison-item">
                            <span class="comparison-label">vs Last Year:</span>
                            <span class="comparison-value" id="regVsLastYear">--</span>
                        </div>
                        <div class="comparison-item">
                            <span class="comparison-label">Rate Change:</span>
                            <span class="comparison-value" id="rateChange">--</span>
                        </div>
                    </div>
                    <div class="registration-chart-container">
                        <canvas id="conversionTrendChart"></canvas>
                    </div>
                    <div class="registration-insights">
                        <div class="insight-card">
                            <div class="insight-header">
                                <span class="insight-icon">üéØ</span>
                                <span class="insight-label">Registration Target</span>
                            </div>
                            <div class="insight-value" id="regTarget">--</div>
                            <div class="insight-detail" id="regTargetDetail">--</div>
                            <div class="insight-progress">
                                <div class="insight-progress-fill" id="regTargetProgress"></div>
                            </div>
                        </div>
                        <div class="insight-card">
                            <div class="insight-header">
                                <span class="insight-icon">üìà</span>
                                <span class="insight-label">Today's Conversions</span>
                            </div>
                            <div class="insight-value" id="todayConversions">--</div>
                            <div class="insight-detail" id="conversionDetail">--</div>
                        </div>
                        <div class="insight-card">
                            <div class="insight-header">
                                <span class="insight-icon">‚ö°</span>
                                <span class="insight-label">Campus Leaders</span>
                            </div>
                            <div class="campus-conversion-list" id="campusConversionList">
                                <!-- Will be populated -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="section-divider"></div>
        
        <!-- Key Performance Indicators -->
        <div class="kpi-section">
            <h2 class="kpi-title">Key Performance Indicators</h2>
            <div class="kpi-grid">
                <div class="kpi-card">
                    <div class="kpi-icon">üìä</div>
                    <div class="kpi-content">
                        <div class="kpi-label">Weekly Momentum</div>
                        <div class="kpi-value" id="weeklyMomentum">--</div>
                        <div class="kpi-trend" id="weeklyTrend">--</div>
                    </div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-icon">üéØ</div>
                    <div class="kpi-content">
                        <div class="kpi-label">Conversion Quality</div>
                        <div class="kpi-value" id="conversionQuality">--</div>
                        <div class="kpi-trend" id="conversionTrend">--</div>
                    </div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-icon">üèõÔ∏è</div>
                    <div class="kpi-content">
                        <div class="kpi-label">Campus Health Score</div>
                        <div class="kpi-value" id="campusHealth">--</div>
                        <div class="kpi-trend" id="campusTrend">--</div>
                    </div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-icon">üìà</div>
                    <div class="kpi-content">
                        <div class="kpi-label">Pace to Target</div>
                        <div class="kpi-value" id="paceToTarget">--</div>
                        <div class="kpi-trend" id="paceTrend">--</div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="section-divider"></div>
        
        <!-- Alerts Section -->
        <div class="alerts-section">
            <div class="alerts-header">
                <div class="alert-icon">!</div>
                <h2 class="alerts-title">Key Metrics & Insights</h2>
            </div>
            <div id="alertsContainer">
                <!-- Alerts will be dynamically populated -->
            </div>
        </div>
        
        <div class="section-divider"></div>
        
        <!-- Key Metrics Section -->
        <div class="metrics-section">
            <div class="metrics-header">
                <h2 class="metrics-title">Key Performance Metrics</h2>
                <div class="view-toggle">
                    <button class="active" onclick="changeView('daily')">Daily</button>
                    <button onclick="changeView('weekly')">Weekly</button>
                    <button onclick="changeView('monthly')">Monthly</button>
                </div>
            </div>
            <div class="metrics-grid" id="metricsGrid">
                <!-- Metrics will be dynamically populated -->
            </div>
            <div class="chart-divider"></div>
            <div class="chart-container small">
                <canvas id="trendChart"></canvas>
            </div>
            <div class="chart-divider"></div>
            <div class="chart-container" style="height: 500px;">
                <canvas id="cumulativeChart"></canvas>
            </div>
        </div>
        
        <!-- Campus Performance (Expandable) -->
        <div class="expandable-section">
            <div class="expandable-header" onclick="toggleSection('campus')">
                <h2 class="expandable-title">Campus Details</h2>
                <svg class="expand-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                </svg>
            </div>
            <div class="expandable-content" id="campusContent">
                <table class="data-table" id="campusTable">
                    <!-- Campus data will be populated here -->
                </table>
                <div class="chart-divider"></div>
                <div class="chart-container">
                    <canvas id="campusChart"></canvas>
                </div>
            </div>
        </div>
        
        <!-- Historical Trends (Expandable) -->
        <div class="expandable-section">
            <div class="expandable-header" onclick="toggleSection('trends')">
                <h2 class="expandable-title">Historical Trends & Projections</h2>
                <svg class="expand-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                </svg>
            </div>
            <div class="expandable-content" id="trendsContent">
                <div class="chart-container">
                    <canvas id="historicalChart"></canvas>
                </div>
                <div class="chart-divider"></div>
                <div class="chart-container">
                    <canvas id="projectionChart"></canvas>
                </div>
            </div>
        </div>
        
        <!-- Detailed Analytics (Expandable) -->
        <div class="expandable-section">
            <div class="expandable-header" onclick="toggleSection('analytics')">
                <h2 class="expandable-title">Detailed Analytics</h2>
                <svg class="expand-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                </svg>
            </div>
            <div class="expandable-content" id="analyticsContent">
                <div class="metrics-grid" style="grid-template-columns: 1fr; gap: 0;">
                    <div class="chart-container">
                        <canvas id="weekPatternChart"></canvas>
                    </div>
                    <div class="chart-divider"></div>
                    <div class="chart-container">
                        <canvas id="conversionChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // Data from the updated dashboard (July 21, 2025 - Day 38)
        const day47Data = {
        "Akkar": {
                "2019": {
                        "accApplicants": 10,
                        "accRegistered": 4,
                        "dailyApplicants": 0
                },
                "2023": {
                        "accApplicants": 15,
                        "accRegistered": 0,
                        "dailyApplicants": 1
                },
                "2024": {
                        "accApplicants": 34,
                        "accRegistered": 26,
                        "dailyApplicants": 3
                },
                "2025": {
                        "accApplicants": 41,
                        "accRegistered": 7,
                        "dailyApplicants": 0
                }
        },
        "Beirut": {
                "2019": {
                        "accApplicants": 1590,
                        "accRegistered": 980,
                        "dailyApplicants": 58
                },
                "2023": {
                        "accApplicants": 885,
                        "accRegistered": 559,
                        "dailyApplicants": 58
                },
                "2024": {
                        "accApplicants": 866,
                        "accRegistered": 606,
                        "dailyApplicants": 52
                },
                "2025": {
                        "accApplicants": 779,
                        "accRegistered": 140,
                        "dailyApplicants": 9
                }
        },
        "Mount Lebanon": {
                "2019": {
                        "accApplicants": 120,
                        "accRegistered": 77,
                        "dailyApplicants": 3
                },
                "2023": {
                        "accApplicants": 114,
                        "accRegistered": 82,
                        "dailyApplicants": 6
                },
                "2024": {
                        "accApplicants": 105,
                        "accRegistered": 86,
                        "dailyApplicants": 7
                },
                "2025": {
                        "accApplicants": 65,
                        "accRegistered": 18,
                        "dailyApplicants": 0
                }
        },
        "Nabatieh": {
                "2019": {
                        "accApplicants": 41,
                        "accRegistered": 19,
                        "dailyApplicants": 1
                },
                "2023": {
                        "accApplicants": 90,
                        "accRegistered": 49,
                        "dailyApplicants": 1
                },
                "2024": {
                        "accApplicants": 112,
                        "accRegistered": 68,
                        "dailyApplicants": 10
                },
                "2025": {
                        "accApplicants": 56,
                        "accRegistered": 3,
                        "dailyApplicants": 2
                }
        },
        "Saida": {
                "2019": {
                        "accApplicants": 288,
                        "accRegistered": 163,
                        "dailyApplicants": 117
                },
                "2023": {
                        "accApplicants": 197,
                        "accRegistered": 127,
                        "dailyApplicants": 1
                },
                "2024": {
                        "accApplicants": 235,
                        "accRegistered": 181,
                        "dailyApplicants": 30
                },
                "2025": {
                        "accApplicants": 145,
                        "accRegistered": 15,
                        "dailyApplicants": 7
                }
        },
        "Tripoli": {
                "2019": {
                        "accApplicants": 72,
                        "accRegistered": 7,
                        "dailyApplicants": 6
                },
                "2023": {
                        "accApplicants": 149,
                        "accRegistered": 39,
                        "dailyApplicants": 7
                },
                "2024": {
                        "accApplicants": 94,
                        "accRegistered": 61,
                        "dailyApplicants": 21
                },
                "2025": {
                        "accApplicants": 55,
                        "accRegistered": 2,
                        "dailyApplicants": 0
                }
        },
        "Tyre": {
                "2019": {
                        "accApplicants": 81,
                        "accRegistered": 53,
                        "dailyApplicants": 56
                },
                "2023": {
                        "accApplicants": 95,
                        "accRegistered": 55,
                        "dailyApplicants": 9
                },
                "2024": {
                        "accApplicants": 72,
                        "accRegistered": 44,
                        "dailyApplicants": 11
                },
                "2025": {
                        "accApplicants": 46,
                        "accRegistered": 0,
                        "dailyApplicants": 0
                }
        }
};

        // Global variables
        let currentView = 'daily';
        let charts = {};
        let metrics = {};
        
        // Calculate totals and metrics
        function calculateMetrics() {
            const localMetrics = {};
            
            // Current year totals
            let total2025 = 0;
            let registered2025 = 0;
            let daily2025 = 0;
            
            // Previous years for comparison
            let total2024 = 0;
            let registered2024 = 0;
            let total2023 = 0;
            let total2019 = 0;
            
            for (const campus in day47Data) {
                total2025 += day47Data[campus]["2025"].accApplicants || 0;
                registered2025 += day47Data[campus]["2025"].accRegistered || 0;
                daily2025 += day47Data[campus]["2025"].dailyApplicants || 0;
                
                total2024 += day47Data[campus]["2024"].accApplicants || 0;
                registered2024 += day47Data[campus]["2024"].accRegistered || 0;
                total2023 += day47Data[campus]["2023"].accApplicants || 0;
                total2019 += day47Data[campus]["2019"].accApplicants || 0;
            }
            
            // Use ACTUAL data from Excel files for current totals
            localMetrics.total = 1187; // Real total from Excel files (Day 47)
            localMetrics.registered = 185; // Real registered from Excel files (Day 47)
            localMetrics.daily = daily2025;
            // Calculate the actual current day conversion rate from the real data
            localMetrics.registrationRate = (185 / 1187 * 100).toFixed(1); // Real data: 185 registered / 1187 applicants = 15.6%
            
            // Calculate averages
            const currentDay = 47; // Current day in the cycle
            localMetrics.currentDay = currentDay;
            localMetrics.dailyAvg = (localMetrics.total / currentDay).toFixed(1);
            localMetrics.weeklyAvg = (localMetrics.total / (currentDay / 7)).toFixed(0); // weeks
            
            // Weekly data for 2025 (real data from Excel analysis)
            localMetrics.weeklyTotals2025 = [52, 50, 80, 58, 200, 375, 270]; // Weeks 1-7 from Excel
            localMetrics.weeklyTotals2024 = [58, 49, 94, 217, 260, 156, 175]; // Weeks 1-7 for comparison
            
            // Calculate week-over-week change (Week 4 to Week 5)
            localMetrics.weekOverWeek = ((localMetrics.weeklyTotals2025[4] - localMetrics.weeklyTotals2025[3]) / localMetrics.weeklyTotals2025[3] * 100).toFixed(1);
            
            // Day of week patterns for 2025
            localMetrics.dayOfWeekTotals = {
                'Mon': 115,
                'Tue': 97,
                'Wed': 139,
                'Thu': 98,
                'Fri': 78,
                'Sat': 12,
                'Sun': 18
            };
            
            // Calculate changes
            localMetrics.changeVs2024 = total2024 > 0 ? ((total2025 - total2024) / total2024 * 100).toFixed(1) : 0;
            localMetrics.changeVs2023 = total2023 > 0 ? ((total2025 - total2023) / total2023 * 100).toFixed(1) : 0;
            localMetrics.changeVs2019 = total2019 > 0 ? ((total2025 - total2019) / total2019 * 100).toFixed(1) : 0;
            
            // Registration rate comparison - use real Day 47 data from 2024
            localMetrics.regRate2024 = "69.4"; // Real data from Excel analysis: 69.4% overall rate for 2024-2025
            
            // Calculate projections
            const remainingDays = 139 - currentDay;
            localMetrics.projectedTotal = Math.round(localMetrics.total + (localMetrics.dailyAvg * remainingDays));
            localMetrics.targetTotal = 2700; // Based on historical averages
            localMetrics.requiredDaily = ((localMetrics.targetTotal - localMetrics.total) / remainingDays).toFixed(1);
            
            // Calculate if on track
            localMetrics.onTrack = localMetrics.dailyAvg >= localMetrics.requiredDaily;
            localMetrics.percentToTarget = ((localMetrics.projectedTotal / localMetrics.targetTotal) * 100).toFixed(1);
            
            // Store in global metrics
            metrics = localMetrics;
            return localMetrics;
        }
        
        // Generate alerts based on metrics
        function generateAlerts(metrics) {
            const alerts = [];
            
            // Key metrics
            if (!metrics.onTrack) {
                const deficit = metrics.targetTotal - metrics.projectedTotal;
                alerts.push({
                    type: 'info',
                    message: `Projected shortfall of ${deficit.toLocaleString()} applications`,
                    detail: `Current trajectory: ${metrics.projectedTotal.toLocaleString()} vs Target: ${metrics.targetTotal.toLocaleString()}`
                });
            }
            
            // Check campus-specific performance
            const lowPerformanceCampuses = [];
            const underperformingCampuses = [];
            for (const campus in day47Data) {
                const current = day47Data[campus]["2025"].accApplicants;
                const lastYear = day47Data[campus]["2024"].accApplicants;
                const change = lastYear > 0 ? ((current - lastYear) / lastYear * 100).toFixed(1) : 0;
                
                if (parseFloat(change) < -30) {
                    lowPerformanceCampuses.push({name: campus, change: change});
                } else if (parseFloat(change) < -15) {
                    underperformingCampuses.push({name: campus, change: change});
                }
            }
            
            if (lowPerformanceCampuses.length > 0) {
                alerts.push({
                    type: 'info',
                    message: `${lowPerformanceCampuses.length} campus${lowPerformanceCampuses.length > 1 ? 'es' : ''} showing significant change`,
                    detail: lowPerformanceCampuses.map(c => `${c.name}: ${c.change}%`).join(', ')
                });
            }
            
            if (underperformingCampuses.length > 0) {
                alerts.push({
                    type: 'warning',
                    message: `${underperformingCampuses.length} campus${underperformingCampuses.length > 1 ? 'es' : ''} underperforming`,
                    detail: `Requires intervention to prevent further decline`
                });
            }
            
            // Weekly momentum alert
            const weekChange = parseFloat(metrics.weekOverWeek);
            if (weekChange < -20) {
                alerts.push({
                    type: 'warning',
                    message: `Weekly applications declined ${Math.abs(weekChange)}%`,
                    detail: `Week 5: ${metrics.weeklyTotals2025[4]} vs Week 4: ${metrics.weeklyTotals2025[3]}`
                });
            }
            
            // Registration rate comparison
            const regRateDrop = parseFloat(metrics.regRate2024) - parseFloat(metrics.registrationRate);
            alerts.unshift({
                type: 'info',
                message: `Registration rate decreased by ${regRateDrop.toFixed(1)} percentage points`,
                detail: `Current: ${metrics.registrationRate}% vs Last Year: ${metrics.regRate2024}%`
            });
            
            // Add specific registration recovery alert
            const neededRegistrations = Math.round(metrics.total * 0.694) - metrics.registered;
            alerts.push({
                type: 'info',
                message: `${neededRegistrations} additional registrations needed to match last year's rate`,
                detail: `Must convert ${(neededRegistrations / (metrics.total - metrics.registered) * 100).toFixed(1)}% of remaining ${metrics.total - metrics.registered} applicants`
            });
            
            return alerts;
        }
        
        function calculateLastYearTotal() {
            return 1384; // From Excel data at Day 47
        }
        
        function calculateTotal2023() {
            return 1545; // From Excel data at Day 47
        }
        
        function calculateTotal2019() {
            return 2202; // From Excel data at Day 47
        }
        
        // Render alerts
        function renderAlerts() {
            const metrics = calculateMetrics();
            const alerts = generateAlerts(metrics);
            const container = document.getElementById('alertsContainer');
            
            container.innerHTML = alerts.map(alert => `
                <div class="alert-item">
                    <div class="alert-indicator ${alert.type}"></div>
                    <div class="alert-content">
                        <div class="alert-message">${alert.message}</div>
                        <div class="alert-detail">${alert.detail}</div>
                    </div>
                </div>
            `).join('');
        }
        
        // Render metrics cards
        function renderMetrics() {
            const metrics = calculateMetrics();
            const container = document.getElementById('metricsGrid');
            
            let metricsHTML = '';
            
            if (currentView === 'weekly') {
                metricsHTML = `
                    <div class="metric-card ${metrics.onTrack ? 'positive' : 'below-target'}">
                        <div class="metric-label">Weekly Average</div>
                        <div class="metric-value">${Math.round(metrics.weeklyAvg)}</div>
                        <div class="metric-change ${parseFloat(metrics.changeVs2024) >= 0 ? 'positive' : 'negative'}">
                            ${parseFloat(metrics.changeVs2024) >= 0 ? '‚Üë' : '‚Üì'} ${Math.abs(metrics.changeVs2024)}% vs Fall 2024-2025
                        </div>
                    </div>
                    <div class="metric-card ${metrics.onTrack ? 'positive' : 'warning'}">
                        <div class="metric-label">On Track Status</div>
                        <div class="metric-value">${metrics.onTrack ? 'YES' : 'NO'}</div>
                        <div class="metric-change">
                            Need ${metrics.requiredDaily}/day
                        </div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-label">Projected Total</div>
                        <div class="metric-value">${metrics.projectedTotal.toLocaleString()}</div>
                        <div class="metric-change ${metrics.projectedTotal >= metrics.targetTotal ? 'positive' : 'negative'}">
                            ${metrics.percentToTarget > 100 ? 'On track to exceed target of ' + metrics.targetTotal.toLocaleString() + ' by ' + (metrics.percentToTarget - 100).toFixed(1) + '%' : 'Need ' + (100 - metrics.percentToTarget).toFixed(1) + '% more to reach target of ' + metrics.targetTotal.toLocaleString()}
                        </div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-label">Registration Rate</div>
                        <div class="metric-value">${metrics.registrationRate}%</div>
                        <div class="metric-change ${parseFloat(metrics.registrationRate) > parseFloat(metrics.regRate2024) ? 'positive' : 'negative'}">
                            vs ${metrics.regRate2024}% last year
                        </div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-label">Total Applications</div>
                        <div class="metric-value">${metrics.total}</div>
                        <div class="metric-change ${parseFloat(metrics.changeVs2024) >= 0 ? 'positive' : 'negative'}">
                            ${parseFloat(metrics.changeVs2024) >= 0 ? '‚Üë' : '‚Üì'} ${Math.abs(metrics.changeVs2024)}% YoY
                        </div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-label">Week-over-Week Change</div>
                        <div class="metric-value">${metrics.weekOverWeek}%</div>
                        <div class="metric-change ${parseFloat(metrics.weekOverWeek) >= 0 ? 'positive' : 'negative'}">
                            Week 5: ${metrics.weeklyTotals2025[4]} vs Week 4: ${metrics.weeklyTotals2025[3]}
                        </div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-label">Current Week (Week 5)</div>
                        <div class="metric-value">${metrics.weeklyTotals2025[4]}</div>
                        <div class="metric-change ${metrics.weeklyTotals2025[4] > metrics.weeklyTotals2024[4] ? 'positive' : 'negative'}">
                            vs ${metrics.weeklyTotals2024[4]} last year
                        </div>
                    </div>
                `;
            } else if (currentView === 'daily') {
                // Calculate daily applications for Day 43 across all semesters
                // Sum up daily applications from all campuses for each year
                let day41Daily = {
                    2019: 0,
                    2023: 0,
                    2024: 0,
                    2025: 0
                };
                
                for (const campus in day47Data) {
                    day41Daily[2019] += day47Data[campus]["2019"].dailyApplicants || 0;
                    day41Daily[2023] += day47Data[campus]["2023"].dailyApplicants || 0;
                    day41Daily[2024] += day47Data[campus]["2024"].dailyApplicants || 0;
                    day41Daily[2025] += day47Data[campus]["2025"].dailyApplicants || 0;
                }
                
                // Create comparison table HTML
                const comparisonTableHTML = `
                    <div style="grid-column: 1 / -1; background: white; padding: 1rem; border-radius: 8px; margin-bottom: 1rem;">
                        <h3 style="font-size: 1rem; margin-bottom: 0.75rem; font-weight: 600;">Day 47 Daily Applications Comparison</h3>
                        <table class="data-table" style="margin: 0;">
                            <thead>
                                <tr>
                                    <th>Semester</th>
                                    <th>Daily Apps</th>
                                    <th>Total to Date</th>
                                    <th>vs Current</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr style="${metrics.daily > 0 ? 'background: #fef3c7;' : ''}">
                                    <td><strong>Fall 2025-2026 (Thursday)</strong></td>
                                    <td><strong>${day41Daily[2025]}</strong></td>
                                    <td><strong>${metrics.total}</strong></td>
                                    <td>Current</td>
                                </tr>
                                <tr>
                                    <td>Fall 2024-2025 (Wednesday)</td>
                                    <td>${day41Daily[2024]}</td>
                                    <td>${calculateLastYearTotal()}</td>
                                    <td class="${day41Daily[2025] >= day41Daily[2024] ? 'text-positive' : 'text-negative'}">
                                        ${day41Daily[2025] >= day41Daily[2024] ? '‚Üë' : '‚Üì'} ${Math.abs(day41Daily[2025] - day41Daily[2024])}
                                    </td>
                                </tr>
                                <tr>
                                    <td>Fall 2023-2024 (Monday)</td>
                                    <td>${day41Daily[2023]}</td>
                                    <td>${calculateTotal2023()}</td>
                                    <td class="${day41Daily[2025] >= day41Daily[2023] ? 'text-positive' : 'text-negative'}">
                                        ${day41Daily[2025] >= day41Daily[2023] ? '‚Üë' : '‚Üì'} ${Math.abs(day41Daily[2025] - day41Daily[2023])}
                                    </td>
                                </tr>
                                <tr>
                                    <td>Fall 2019-2020 (Wednesday)</td>
                                    <td>${day41Daily[2019]}</td>
                                    <td>${calculateTotal2019()}</td>
                                    <td class="${day41Daily[2025] >= day41Daily[2019] ? 'text-positive' : 'text-negative'}">
                                        ${day41Daily[2025] >= day41Daily[2019] ? '‚Üë' : '‚Üì'} ${Math.abs(day41Daily[2025] - day41Daily[2019])}
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                `;
                
                metricsHTML = comparisonTableHTML + `
                    <div class="metric-card">
                        <div class="metric-label">Daily Average</div>
                        <div class="metric-value">${metrics.dailyAvg}</div>
                        <div class="metric-change ${parseFloat(metrics.dailyAvg) >= parseFloat(metrics.requiredDaily) ? 'positive' : 'negative'}">
                            Target: ${metrics.requiredDaily}/day
                        </div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-label">Registration Rate</div>
                        <div class="metric-value">${metrics.registrationRate}%</div>
                        <div class="metric-change">
                            ${metrics.registered} registered
                        </div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-label">On Track Status</div>
                        <div class="metric-value">${metrics.onTrack ? 'YES' : 'NO'}</div>
                        <div class="metric-change ${metrics.onTrack ? 'positive' : 'negative'}">
                            ${metrics.percentToTarget > 100 ? 'On track to exceed target of ' + metrics.targetTotal.toLocaleString() + ' by ' + (metrics.percentToTarget - 100).toFixed(1) + '%' : 'Need ' + (100 - metrics.percentToTarget).toFixed(1) + '% more to reach target of ' + metrics.targetTotal.toLocaleString()}
                        </div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-label">Cycle Progress</div>
                        <div class="metric-value">30.9%</div>
                        <div class="metric-change">
                            96 days remaining
                        </div>
                    </div>
                `;
            } else if (currentView === 'monthly') {
                // Monthly view metrics
                const june15to30 = metrics.weeklyTotals2025[0] + metrics.weeklyTotals2025[1] + (metrics.weeklyTotals2025[2] * 0.5); // Approx 2.5 weeks
                const july1to19 = (metrics.weeklyTotals2025[2] * 0.5) + metrics.weeklyTotals2025[3] + metrics.weeklyTotals2025[4]; // Approx 2.5 weeks
                
                metricsHTML = `
                    <div class="metric-card">
                        <div class="metric-label">June 15-30 Total</div>
                        <div class="metric-value">${Math.round(june15to30)}</div>
                        <div class="metric-change">
                            First 16 days
                        </div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-label">July 1-19 Total</div>
                        <div class="metric-value">${Math.round(july1to19)}</div>
                        <div class="metric-change">
                            19 days
                        </div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-label">Monthly Average</div>
                        <div class="metric-value">${Math.round(metrics.total / 1.17)}</div>
                        <div class="metric-change">
                            Per 30 days
                        </div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-label">Total Applications</div>
                        <div class="metric-value">${metrics.total}</div>
                        <div class="metric-change ${parseFloat(metrics.changeVs2024) >= 0 ? 'positive' : 'negative'}">
                            ${parseFloat(metrics.changeVs2024) >= 0 ? '‚Üë' : '‚Üì'} ${Math.abs(metrics.changeVs2024)}% YoY
                        </div>
                    </div>
                `;
            }
            
            container.innerHTML = metricsHTML;
            updateTrendChart();
            updateCumulativeChart(metrics);
        }
        
        // Update cumulative chart
        function updateCumulativeChart(metrics) {
            const ctx = document.getElementById('cumulativeChart').getContext('2d');
            
            if (charts.cumulative) {
                charts.cumulative.destroy();
            }
            
            // Generate day labels for all days up to current day
            const currentDay = metrics.currentDay || 45; // Get from metrics or default
            const dayLabels = [];
            for (let i = 1; i <= currentDay; i++) {
                dayLabels.push(i);
            }
            
            // EXACT cumulative data from Excel files analysis
            const data2025 = [57, 64, 74, 87, 97, 105, 106, 107, 124, 140, 150, 152, 156, 156, 157, 170, 191, 215, 227, 234, 236, 240, 243, 258, 275, 282, 289, 294, 300, 325, 350, 399, 449, 489, 494, 499, 576, 666, 736, 825, 862, 869, 878, 982, 1045, 1085, 1085]; // Updated to match Excel: 1085 total
            
            const data2024 = [58, 58, 59, 61, 62, 70, 74, 75, 76, 88, 97, 105, 115, 123, 124, 127, 140, 158, 164, 196, 217, 221, 227, 233, 301, 362, 415, 434, 444, 448, 520, 572, 577, 656, 694, 698, 704, 796, 876, 949, 1007, 1029, 1032, 1048, 1209, 1384, 1518];
            
            const data2023 = [413, 426, 430, 438, 460, 475, 494, 507, 511, 515, 521, 538, 546, 548, 550, 557, 561, 568, 591, 620, 651, 668, 674, 680, 686, 706, 716, 737, 755, 769, 787, 798, 882, 963, 990, 1063, 1100, 1112, 1124, 1211, 1278, 1344, 1413, 1437, 1451, 1462, 1545];
            
            const data2019 = [197, 198, 209, 220, 231, 240, 247, 247, 252, 266, 273, 296, 323, 350, 353, 355, 390, 426, 456, 482, 499, 499, 501, 550, 592, 648, 739, 781, 785, 789, 912, 1016, 1084, 1145, 1201, 1208, 1213, 1347, 1452, 1525, 1629, 1670, 1673, 1680, 1812, 1961, 2202];
            
            charts.cumulative = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: dayLabels,
                    datasets: [
                        {
                            label: 'Fall 2025',
                            data: data2025,
                            borderColor: '#f59e0b',
                            backgroundColor: 'rgba(245, 158, 11, 0.1)',
                            borderWidth: 2,
                            tension: 0.4,
                            pointRadius: 3,
                            pointBackgroundColor: 'white',
                            pointBorderColor: '#f59e0b',
                            pointBorderWidth: 2,
                            pointHoverRadius: 6
                        },
                        {
                            label: 'Fall 2024',
                            data: data2024,
                            borderColor: '#10b981',
                            backgroundColor: 'rgba(16, 185, 129, 0.1)',
                            borderWidth: 2,
                            tension: 0.4,
                            pointRadius: 3,
                            pointBackgroundColor: 'white',
                            pointBorderColor: '#10b981',
                            pointBorderWidth: 2,
                            pointHoverRadius: 6
                        },
                        {
                            label: 'Fall 2023',
                            data: data2023,
                            borderColor: '#3b82f6',
                            backgroundColor: 'rgba(59, 130, 246, 0.1)',
                            borderWidth: 2,
                            tension: 0.4,
                            pointRadius: 3,
                            pointBackgroundColor: 'white',
                            pointBorderColor: '#3b82f6',
                            pointBorderWidth: 2,
                            pointHoverRadius: 6
                        },
                        {
                            label: 'Fall 2019',
                            data: data2019,
                            borderColor: '#a855f7',
                            backgroundColor: 'rgba(168, 85, 247, 0.1)',
                            borderWidth: 2,
                            tension: 0.4,
                            pointRadius: 3,
                            pointBackgroundColor: 'white',
                            pointBorderColor: '#a855f7',
                            pointBorderWidth: 2,
                            pointHoverRadius: 6
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        mode: 'index',
                        intersect: false
                    },
                    plugins: {
                        title: {
                            display: true,
                            text: 'Cumulative Applications - First 47 Days',
                            font: {
                                size: 16,
                                weight: 'normal'
                            },
                            padding: {
                                top: 10,
                                bottom: 20
                            }
                        },
                        legend: {
                            display: true,
                            position: 'top',
                            labels: {
                                usePointStyle: true,
                                padding: 20,
                                font: {
                                    size: 12
                                }
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(255, 255, 255, 0.95)',
                            titleColor: '#1a1a1a',
                            bodyColor: '#1a1a1a',
                            borderColor: '#e5e7eb',
                            borderWidth: 1,
                            padding: 12,
                            displayColors: true,
                            callbacks: {
                                label: function(context) {
                                    return context.dataset.label + ': ' + context.parsed.y.toLocaleString() + ' applications';
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Total Applications'
                            },
                            ticks: {
                                callback: function(value) {
                                    return value.toLocaleString();
                                }
                            },
                            grid: {
                                color: '#f3f4f6'
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            },
                            title: {
                                display: true,
                                text: 'Day'
                            },
                            ticks: {
                                maxRotation: 0,
                                autoSkip: true,
                                maxTicksLimit: 18,
                                callback: function(value, index) {
                                    // Show every other day
                                    return index % 2 === 0 ? 'Day ' + this.getLabelForValue(value) : '';
                                }
                            }
                        }
                    }
                }
            });
        }
        
        // Update trend chart
        function updateTrendChart() {
            const ctx = document.getElementById('trendChart').getContext('2d');
            
            if (charts.trend) {
                charts.trend.destroy();
            }
            
            // Use real weekly data
            const labels = currentView === 'weekly' ? 
                ['Week 1', 'Week 2', 'Week 3', 'Week 4', 'Week 5'] :
                currentView === 'monthly' ?
                ['June 15-30', 'July 1-19'] :
                ['Day 38', 'Day 38', 'Day 38', 'Day 38'];
            
            const data = currentView === 'weekly' ?
                metrics.weeklyTotals2025 :
                currentView === 'daily' ?
                [15, 18, 12, 2] : // Daily applications for last 4 days
                [184, 313]; // Monthly totals
            
            // For weekly view, also show last year's data for comparison
            const datasets = currentView === 'weekly' ? [
                {
                    label: 'Fall 2025-2026',
                    data: metrics.weeklyTotals2025,
                    borderColor: '#3b82f6',
                    backgroundColor: 'rgba(59, 130, 246, 0.1)',
                    tension: 0.4,
                    fill: true
                },
                {
                    label: 'Fall 2024-2025',
                    data: metrics.weeklyTotals2024,
                    borderColor: '#10b981',
                    backgroundColor: 'rgba(16, 185, 129, 0.1)',
                    tension: 0.4,
                    fill: true
                }
            ] : currentView === 'daily' ? [{
                label: 'Daily Applications',
                data: data,
                backgroundColor: ['#3b82f6', '#3b82f6', '#3b82f6', '#ef4444'],
                borderColor: ['#2563eb', '#2563eb', '#2563eb', '#dc2626'],
                borderWidth: 2
            }] : [{
                label: 'Applications by Period',
                data: data,
                backgroundColor: ['#3b82f6', '#10b981'],
                borderColor: ['#2563eb', '#059669'],
                borderWidth: 2
            }];
            
            charts.trend = new Chart(ctx, {
                type: currentView === 'weekly' ? 'line' : 'bar',
                data: {
                    labels: labels,
                    datasets: datasets
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: currentView === 'weekly'
                        },
                        title: {
                            display: currentView === 'daily',
                            text: 'Last 4 Days Applications Trend'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                display: false
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            }
                        }
                    }
                }
            });
        }
        
        // Toggle expandable sections
        function toggleSection(section) {
            const header = event.currentTarget;
            const content = document.getElementById(section + 'Content');
            
            header.classList.toggle('expanded');
            content.classList.toggle('expanded');
            
            // Initialize charts when sections are opened
            if (content.classList.contains('expanded')) {
                setTimeout(() => {
                    if (section === 'campus') {
                        renderCampusTable();
                        renderCampusChart();
                    } else if (section === 'trends') {
                        window.renderHistoricalChart();
                        window.renderProjectionChart();
                    } else if (section === 'analytics') {
                        window.renderWeekPatternChart();
                        window.renderConversionChart();
                    }
                }, 300);
            }
        }
        
        // Render campus table
        function renderCampusTable() {
            const tbody = document.getElementById('campusTable');
            const campuses = Object.keys(day47Data);
            
            // Sort campuses by 2025 applications (highest to lowest)
            const sortedCampuses = campuses.sort((a, b) => {
                return day47Data[b]["2025"].accApplicants - day47Data[a]["2025"].accApplicants;
            });
            
            let html = `
                <thead>
                    <tr>
                        <th>Campus</th>
                        <th>Applications</th>
                        <th>YoY Change</th>
                        <th>% of Total</th>
                        <th>Registration Rate</th>
                    </tr>
                </thead>
                <tbody>
            `;
            
            sortedCampuses.forEach(campus => {
                const current = day47Data[campus]["2025"];
                const lastYear = day47Data[campus]["2024"];
                const change = lastYear.accApplicants > 0 ? 
                    ((current.accApplicants - lastYear.accApplicants) / lastYear.accApplicants * 100).toFixed(1) : 0;
                const rate = current.accApplicants > 0 ? 
                    (current.accRegistered / current.accApplicants * 100).toFixed(1) : 0;
                const total2025 = sortedCampuses.reduce((sum, c) => sum + day47Data[c]["2025"].accApplicants, 0);
                const percentOfTotal = ((current.accApplicants / total2025) * 100).toFixed(1);
                
                // Performance indicator based on multiple factors
                let performanceClass = '';
                let performanceText = '';
                if (parseFloat(change) < -20) {
                    performanceClass = 'performance-low';
                    performanceText = 'Below Target';
                } else if (parseFloat(change) < -10) {
                    performanceClass = 'performance-warning';
                    performanceText = 'Needs Attention';
                } else if (parseFloat(change) >= 0) {
                    performanceClass = 'performance-good';
                    performanceText = 'On Track';
                } else {
                    performanceClass = 'performance-neutral';
                    performanceText = 'Monitor';
                }
                
                html += `
                    <tr>
                        <td><strong>${campus}</strong></td>
                        <td>${current.accApplicants.toLocaleString()}</td>
                        <td class="${parseFloat(change) >= 0 ? 'text-positive' : 'text-negative'}">
                            <span style="font-weight: 600;">${parseFloat(change) >= 0 ? '+' : ''}${change}%</span>
                        </td>
                        <td>${percentOfTotal}%</td>
                        <td>${rate}%</td>
                    </tr>
                `;
            });
            
            html += '</tbody>';
            tbody.innerHTML = html;
        }
        
        // Render campus chart
        function renderCampusChart() {
            const ctx = document.getElementById('campusChart').getContext('2d');
            
            if (charts.campus) {
                charts.campus.destroy();
            }
            
            const campuses = Object.keys(day47Data);
            // Sort campuses by 2025 applications (highest to lowest) - same as table
            const sortedCampuses = campuses.sort((a, b) => {
                return day47Data[b]["2025"].accApplicants - day47Data[a]["2025"].accApplicants;
            });
            
            const current = sortedCampuses.map(c => day47Data[c]["2025"].accApplicants);
            const lastYear = sortedCampuses.map(c => day47Data[c]["2024"].accApplicants);
            
            charts.campus = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: sortedCampuses,
                    datasets: [
                        {
                            label: 'Fall 2025-2026',
                            data: current,
                            backgroundColor: '#3b82f6'
                        },
                        {
                            label: 'Fall 2024-2025',
                            data: lastYear,
                            backgroundColor: '#e5e7eb'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        }
        
        // Change view
        function changeView(view) {
            currentView = view;
            
            // Update button states
            document.querySelectorAll('.view-toggle button').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Re-render metrics
            renderMetrics();
        }
        
        // Populate Executive Summary
        function populateExecutiveSummary() {
            const metrics = calculateMetrics();
            
            // Target Achievement
            const targetAchievement = document.getElementById('targetAchievement');
            const targetDetail = document.getElementById('targetDetail');
            const percentOfTarget = (metrics.total / metrics.targetTotal * 100).toFixed(1);
            targetAchievement.textContent = percentOfTarget + '%';
            targetAchievement.className = 'summary-value ' + (percentOfTarget >= 100 ? 'positive' : percentOfTarget >= 80 ? 'warning' : 'negative');
            targetDetail.textContent = `${metrics.total.toLocaleString()} of ${metrics.targetTotal.toLocaleString()} target`;
            
            // Projected Total
            const projectedTotalEl = document.getElementById('projectedTotal');
            const projectedDetail = document.getElementById('projectedDetail');
            projectedTotalEl.textContent = metrics.projectedTotal.toLocaleString();
            projectedTotalEl.className = 'summary-value ' + (metrics.projectedTotal >= metrics.targetTotal ? 'positive' : 'negative');
            projectedDetail.textContent = metrics.projectedTotal >= metrics.targetTotal ? 
                `Exceeding target by ${(metrics.projectedTotal - metrics.targetTotal).toLocaleString()}` : 
                `Short by ${(metrics.targetTotal - metrics.projectedTotal).toLocaleString()}`;
            
            // YoY Performance
            const yoyPerformance = document.getElementById('yoyPerformance');
            const yoyDetail = document.getElementById('yoyDetail');
            const yoyChange = parseFloat(metrics.changeVs2024);
            yoyPerformance.textContent = (yoyChange >= 0 ? '+' : '') + yoyChange + '%';
            yoyPerformance.className = 'summary-value ' + (yoyChange >= 0 ? 'positive' : 'negative');
            yoyDetail.textContent = `vs ${calculateLastYearTotal().toLocaleString()} last year`;
            
            // Required Daily Rate
            const requiredRate = document.getElementById('requiredRate');
            const currentRate = document.getElementById('currentRate');
            requiredRate.textContent = metrics.requiredDaily;
            requiredRate.className = 'summary-value ' + (parseFloat(metrics.dailyAvg) >= parseFloat(metrics.requiredDaily) ? 'positive' : 'negative');
            currentRate.textContent = `Current avg: ${metrics.dailyAvg}/day`;
        }
        
        // Populate KPIs
        function populateKPIs() {
            const metrics = calculateMetrics();
            
            // Weekly Momentum
            const weeklyMomentum = document.getElementById('weeklyMomentum');
            const weeklyTrend = document.getElementById('weeklyTrend');
            const currentWeek = metrics.weeklyTotals2025[metrics.weeklyTotals2025.length - 1];
            const previousWeek = metrics.weeklyTotals2025[metrics.weeklyTotals2025.length - 2];
            const weekChange = ((currentWeek - previousWeek) / previousWeek * 100).toFixed(1);
            weeklyMomentum.textContent = currentWeek;
            weeklyTrend.textContent = `${weekChange >= 0 ? '‚Üë' : '‚Üì'} ${Math.abs(weekChange)}% from last week`;
            weeklyTrend.className = 'kpi-trend ' + (weekChange >= 0 ? 'positive' : 'negative');
            
            // Conversion Quality
            const conversionQuality = document.getElementById('conversionQuality');
            const conversionTrend = document.getElementById('conversionTrend');
            conversionQuality.textContent = metrics.registrationRate + '%';
            const rateChange = parseFloat(metrics.registrationRate) - parseFloat(metrics.regRate2024);
            conversionTrend.textContent = `${rateChange >= 0 ? '‚Üë' : '‚Üì'} ${Math.abs(rateChange).toFixed(1)}pp vs last year`;
            conversionTrend.className = 'kpi-trend ' + (rateChange >= 0 ? 'positive' : 'negative');
            
            // Campus Health Score
            const campusHealth = document.getElementById('campusHealth');
            const campusTrend = document.getElementById('campusTrend');
            let healthyCampuses = 0;
            let totalCampuses = 0;
            for (const campus in day47Data) {
                totalCampuses++;
                const current = day47Data[campus]["2025"].accApplicants;
                const lastYear = day47Data[campus]["2024"].accApplicants;
                if (current >= lastYear * 0.9) healthyCampuses++;
            }
            const healthScore = Math.round((healthyCampuses / totalCampuses) * 100);
            campusHealth.textContent = healthScore + '%';
            campusTrend.textContent = `${healthyCampuses} of ${totalCampuses} campuses on track`;
            campusTrend.className = 'kpi-trend ' + (healthScore >= 70 ? 'positive' : 'negative');
            
            // Pace to Target
            const paceToTarget = document.getElementById('paceToTarget');
            const paceTrend = document.getElementById('paceTrend');
            const paceScore = metrics.onTrack ? 'ON TRACK' : 'BEHIND';
            paceToTarget.textContent = paceScore;
            paceToTarget.style.color = metrics.onTrack ? '#10b981' : '#ef4444';
            paceTrend.textContent = `${metrics.percentToTarget}% of target projected`;
            paceTrend.className = 'kpi-trend ' + (metrics.onTrack ? 'positive' : 'negative');
        }
        
        // Populate Daily Changes
        function populateDailyChanges() {
            const metrics = calculateMetrics();
            
            // Ensure chart data arrays are available
            if (typeof data2025 === 'undefined') {
                // Define the data arrays if they're not available yet
                window.data2025 = [57, 64, 74, 87, 97, 105, 106, 107, 124, 140, 150, 152, 156, 156, 157, 170, 191, 215, 227, 234, 236, 240, 243, 258, 275, 282, 289, 294, 300, 325, 350, 399, 449, 489, 494, 499, 576, 666, 736, 825, 862, 869, 878, 982, 1045, 1110, 1166];
            }
            
            // Get current day's data
            const currentDayIndex = metrics.currentDay - 1; // Array index
            const yesterdayIndex = currentDayIndex - 1;
            
            // Daily new applications
            const todayApps = metrics.daily;
            const dailyNewApps = document.getElementById('dailyNewApps');
            const dailyAppDetail = document.getElementById('dailyAppDetail');
            dailyNewApps.textContent = todayApps;
            dailyNewApps.className = 'change-value ' + (todayApps > 0 ? 'positive' : 'negative');
            
            // Calculate same day last week
            let lastWeekDaily = 0;
            if (currentDayIndex >= 7) {
                lastWeekDaily = window.data2025[currentDayIndex - 7] - (currentDayIndex >= 8 ? window.data2025[currentDayIndex - 8] : 0);
            }
            const weekComparison = todayApps - lastWeekDaily;
            dailyAppDetail.textContent = `${weekComparison >= 0 ? '‚Üë' : '‚Üì'} ${Math.abs(weekComparison)} vs same day last week (${lastWeekDaily})`;
            
            // Campus breakdown for today
            const campusBreakdown = document.getElementById('campusBreakdown');
            let topCampuses = [];
            for (const campus in day47Data) {
                const daily = day47Data[campus]["2025"].dailyApplicants;
                if (daily > 0) {
                    topCampuses.push({name: campus, count: daily});
                }
            }
            topCampuses.sort((a, b) => b.count - a.count);
            if (topCampuses.length > 0) {
                campusBreakdown.textContent = topCampuses.slice(0, 3).map(c => `${c.name}: ${c.count}`).join(' | ');
            } else {
                campusBreakdown.textContent = 'No campus data available';
            }
            
            // Total progress
            const totalProgress = document.getElementById('totalProgress');
            const progressDetail = document.getElementById('progressDetail');
            const yesterdayTotal = window.data2025[yesterdayIndex] || 0;
            const todayTotal = metrics.total;
            const progressChange = todayTotal - yesterdayTotal;
            totalProgress.textContent = todayTotal.toLocaleString();
            progressDetail.textContent = `+${progressChange} from yesterday (${yesterdayTotal.toLocaleString()})`;
            
            // Draw sparkline for last 7 days
            const sparklineCanvas = document.getElementById('progressSparkline');
            if (sparklineCanvas) {
                // Set proper canvas dimensions
                const rect = sparklineCanvas.getBoundingClientRect();
                sparklineCanvas.width = rect.width;
                sparklineCanvas.height = 50;
                
                const ctx = sparklineCanvas.getContext('2d');
                const last7Days = window.data2025.slice(Math.max(0, currentDayIndex - 6), currentDayIndex + 1);
                drawSparkline(ctx, last7Days, sparklineCanvas.width, sparklineCanvas.height);
            }
            
            // New registrations (estimated based on rate)
            const newRegistrations = document.getElementById('newRegistrations');
            const registrationDetail = document.getElementById('registrationDetail');
            const conversionRateEl = document.getElementById('conversionRate');
            const estimatedNewReg = Math.round(todayApps * (parseFloat(metrics.registrationRate) / 100));
            newRegistrations.textContent = `+${estimatedNewReg}`;
            newRegistrations.className = 'change-value ' + (estimatedNewReg > 0 ? 'positive' : '');
            registrationDetail.textContent = `From ${todayApps} new applications`;
            conversionRateEl.textContent = `Conversion rate: ${metrics.registrationRate}%`;
            
            // Top 3 performers
            const topCampusesContainer = document.getElementById('topCampusesContainer');
            const topCampusSummary = document.getElementById('topCampusSummary');
            
            if (topCampuses.length > 0) {
                // Display top 3 campuses
                const top3 = topCampuses.slice(0, 3);
                
                // Create a simple, elegant table-like display
                let topDisplay = `
                    <div style="display: flex; flex-direction: column; gap: 0.75rem;">
                `;
                
                top3.forEach((campus, index) => {
                    topDisplay += `
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div style="font-size: 0.95rem;">
                                <span style="color: #9ca3af; margin-right: 0.75rem;">${index + 1}.</span>
                                <span style="font-weight: 600; color: #1a1a1a;">${campus.name}</span>
                            </div>
                            <div style="font-weight: 700; font-size: 1.1rem; color: #1a1a1a;">
                                ${campus.count}
                            </div>
                        </div>
                    `;
                });
                
                topDisplay += '</div>';
                
                topCampusesContainer.innerHTML = topDisplay;
                
                // Summary shows total from top 3
                const top3Total = top3.reduce((sum, c) => sum + c.count, 0);
                const top3Percentage = todayApps > 0 ? ((top3Total / todayApps) * 100).toFixed(0) : 0;
                topCampusSummary.textContent = `Combined: ${top3Total} applications (${top3Percentage}% of total)`;
            } else {
                topCampusesContainer.innerHTML = '<div style="text-align: center; color: #6b7280;">No applications today</div>';
                topCampusSummary.textContent = '';
            }
        }
        
        // Simple sparkline drawing function
        function drawSparkline(ctx, data, width, height) {
            ctx.clearRect(0, 0, width, height);
            if (data.length < 2) return;
            
            // Add padding to prevent overflow
            const padding = 10;
            const drawWidth = width - (padding * 2);
            const drawHeight = height - (padding * 2);
            
            const min = Math.min(...data);
            const max = Math.max(...data);
            const range = max - min || 1;
            const stepX = drawWidth / (data.length - 1);
            
            ctx.strokeStyle = '#3b82f6';
            ctx.lineWidth = 2;
            ctx.beginPath();
            
            data.forEach((value, i) => {
                const x = padding + (i * stepX);
                const y = padding + (drawHeight - ((value - min) / range) * drawHeight);
                if (i === 0) ctx.moveTo(x, y);
                else ctx.lineTo(x, y);
            });
            
            ctx.stroke();
            
            // Add dot for last point
            const lastX = padding + ((data.length - 1) * stepX);
            const lastY = padding + (drawHeight - ((data[data.length - 1] - min) / range) * drawHeight);
            ctx.fillStyle = '#3b82f6';
            ctx.beginPath();
            ctx.arc(lastX, lastY, 3, 0, Math.PI * 2);
            ctx.fill();
        }
        
        // Calculate smart projected date using day-of-week patterns
        function calculateSmartProjectedDate(applicationsNeeded, metrics) {
            // Day of week averages from historical data
            const dayAverages = {
                'Monday': 27.5,    // Average from data
                'Tuesday': 23.3,
                'Wednesday': 33.3,
                'Thursday': 23.5,
                'Friday': 18.7,
                'Saturday': 2.9,   // Very low on weekends
                'Sunday': 4.3      // Very low on weekends
            };
            
            // Start from tomorrow
            let projectedDate = new Date();
            projectedDate.setDate(projectedDate.getDate() + 1);
            
            let remainingApplications = applicationsNeeded;
            let daysProjected = 0;
            const maxDays = 90; // Safety limit
            
            while (remainingApplications > 0 && daysProjected < maxDays) {
                const dayName = projectedDate.toLocaleDateString('en-US', { weekday: 'long' });
                const expectedApps = dayAverages[dayName] || metrics.dailyAvg;
                
                remainingApplications -= expectedApps;
                
                if (remainingApplications > 0) {
                    projectedDate.setDate(projectedDate.getDate() + 1);
                    daysProjected++;
                }
            }
            
            return projectedDate;
        }
        
        // Populate Milestone Tracker
        function populateMilestoneTracker() {
            const metrics = calculateMetrics();
            const currentTotal = metrics.total;
            const dailyAvg = parseFloat(metrics.dailyAvg);
            
            // Define milestones
            const milestones = [1200, 1500, 2000, 2500, 2700];
            
            // Find next milestone
            let nextMilestone = null;
            let nextMilestoneIndex = -1;
            for (let i = 0; i < milestones.length; i++) {
                if (currentTotal < milestones[i]) {
                    nextMilestone = milestones[i];
                    nextMilestoneIndex = i;
                    break;
                }
            }
            
            // Update next milestone card
            if (nextMilestone) {
                const gap = nextMilestone - currentTotal;
                
                // Smart projection using day-of-week patterns
                const projectedDate = calculateSmartProjectedDate(gap, metrics);
                
                document.getElementById('nextMilestoneValue').textContent = nextMilestone.toLocaleString();
                document.getElementById('milestoneDaysAway').textContent = `${gap} applications away`;
                document.getElementById('milestoneProjectedDate').textContent = `Est. ${projectedDate.toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}`;
                
                // Progress bar for next milestone
                const prevMilestone = nextMilestoneIndex > 0 ? milestones[nextMilestoneIndex - 1] : 1000;
                const progress = ((currentTotal - prevMilestone) / (nextMilestone - prevMilestone)) * 100;
                const progressBar = document.getElementById('nextMilestoneProgress');
                progressBar.style.width = Math.min(progress, 100) + '%';
                document.getElementById('nextMilestoneLabel').textContent = `${Math.round(progress)}% to next`;
            } else {
                document.getElementById('nextMilestoneValue').textContent = 'All achieved!';
                document.getElementById('milestoneDaysAway').textContent = 'Excellent progress';
                document.getElementById('milestoneProjectedDate').textContent = '';
                document.getElementById('nextMilestoneProgress').style.width = '100%';
                document.getElementById('nextMilestoneLabel').textContent = '100%';
            }
            
            // Update all milestone items
            milestones.forEach(milestone => {
                const achieved = currentTotal >= milestone;
                const progress = Math.min((currentTotal / milestone) * 100, 100);
                
                // Update status
                const statusEl = document.getElementById(`milestone${milestone}`);
                if (achieved) {
                    statusEl.textContent = '‚úì Achieved';
                    statusEl.className = 'milestone-status achieved';
                } else {
                    const remaining = milestone - currentTotal;
                    statusEl.textContent = `${remaining} to go`;
                    statusEl.className = 'milestone-status';
                }
                
                // Update progress bar
                const progressBar = document.getElementById(`progress${milestone}`);
                progressBar.style.width = progress + '%';
                progressBar.className = achieved ? 'milestone-mini-fill' : 'milestone-mini-fill partial';
            });
        }
        
        // Populate Registration Focus
        function populateRegistrationFocus() {
            const metrics = calculateMetrics();
            
            // Main registration values
            document.getElementById('totalRegistered').textContent = metrics.registered.toLocaleString();
            document.getElementById('currentConversionRate').textContent = metrics.registrationRate + '%';
            
            // Calculate comparisons
            const lastYearReg = 825; // From Excel data at Day 47 last year
            const regDiff = metrics.registered - lastYearReg;
            const regVsLastYear = document.getElementById('regVsLastYear');
            regVsLastYear.textContent = `${regDiff >= 0 ? '+' : ''}${regDiff} (${regDiff >= 0 ? '‚Üë' : '‚Üì'}${Math.abs((regDiff/lastYearReg*100).toFixed(1))}%)`;
            regVsLastYear.className = 'comparison-value ' + (regDiff >= 0 ? 'positive' : 'negative');
            
            const rateChangeEl = document.getElementById('rateChange');
            const rateDiff = parseFloat(metrics.registrationRate) - parseFloat(metrics.regRate2024);
            rateChangeEl.textContent = `${rateDiff >= 0 ? '+' : ''}${rateDiff.toFixed(1)}pp`;
            rateChangeEl.className = 'comparison-value ' + (rateDiff >= 0 ? 'positive' : 'negative');
            
            // Registration target based on historical performance
            // If we match last year's 69.4% rate on projected 2700 applications
            const regTarget = Math.round(2700 * 0.694); // 1874 registrations to match last year's rate
            document.getElementById('regTarget').textContent = regTarget.toLocaleString();
            const regProgress = (metrics.registered / regTarget * 100).toFixed(1);
            document.getElementById('regTargetDetail').textContent = `${regProgress}% of target`;
            document.getElementById('regTargetProgress').style.width = Math.min(regProgress, 100) + '%';
            
            // Today's conversions
            const todayConversions = Math.round(metrics.daily * (metrics.registrationRate / 100));
            document.getElementById('todayConversions').textContent = `+${todayConversions}`;
            document.getElementById('conversionDetail').textContent = `From ${metrics.daily} applications`;
            
            // Campus conversion leaders
            const campusConversionList = document.getElementById('campusConversionList');
            let conversionHTML = '';
            
            // Calculate conversion rates for each campus
            const campusRates = [];
            for (const campus in day47Data) {
                const apps = day47Data[campus]["2025"].accApplicants;
                const regs = day47Data[campus]["2025"].accRegistered;
                if (apps > 0) {
                    const rate = (regs / apps * 100).toFixed(1);
                    campusRates.push({ campus, rate: parseFloat(rate), regs });
                }
            }
            
            // Sort by conversion rate and show top 3
            campusRates.sort((a, b) => b.rate - a.rate);
            campusRates.slice(0, 3).forEach(item => {
                conversionHTML += `
                    <div class="campus-conversion-item">
                        <span>${item.campus}</span>
                        <span class="campus-conversion-rate">${item.rate}%</span>
                    </div>
                `;
            });
            
            campusConversionList.innerHTML = conversionHTML;
            
            // Draw conversion trend chart
            drawConversionTrendChart();
        }
        
        // Draw conversion trend chart
        function drawConversionTrendChart() {
            const canvas = document.getElementById('conversionTrendChart');
            if (!canvas) return;
            
            const ctx = canvas.getContext('2d');
            const rect = canvas.getBoundingClientRect();
            canvas.width = rect.width;
            // Make canvas responsive to container
            const containerHeight = canvas.parentElement.offsetHeight;
            const containerWidth = canvas.parentElement.offsetWidth;
            canvas.height = containerHeight || 280;
            canvas.width = containerWidth || rect.width;
            
            // REAL weekly conversion rates data calculated from Excel files for 2025
            // Actual data from Excel analysis showing gradual then sharp decline
            const weeklyRates = [26.42, 25.64, 27.97, 26.87, 26.11, 19.91, 16.58]; // Accurate rates from Excel
            const weekLabels = ['Jun 15', 'Jun 22', 'Jun 29', 'Jul 6', 'Jul 13', 'Jul 20', 'Jul 31'];
            
            const padding = { left: 60, right: 50, top: 50, bottom: 55 };
            const drawWidth = canvas.width - padding.left - padding.right;
            const drawHeight = canvas.height - padding.top - padding.bottom;
            
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Set up fonts
            ctx.font = '13px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
            
            // Calculate Y-axis range with padding
            const minRate = Math.min(...weeklyRates) - 2;
            const maxRate = Math.max(...weeklyRates) + 2;
            const range = maxRate - minRate;
            
            // Draw subtle grid lines
            ctx.strokeStyle = 'rgba(107, 114, 128, 0.1)';
            ctx.lineWidth = 1;
            for (let i = 0; i <= 5; i++) {
                const y = padding.top + (i * drawHeight / 5);
                const value = maxRate - (i * range / 5);
                
                // Grid line
                ctx.beginPath();
                ctx.moveTo(padding.left, y);
                ctx.lineTo(canvas.width - padding.right, y);
                ctx.stroke();
                
                // Y-axis label
                ctx.fillStyle = '#9ca3af';
                ctx.textAlign = 'right';
                ctx.textBaseline = 'middle';
                ctx.fillText(value.toFixed(1) + '%', padding.left - 5, y);
            }
            
            // Draw X-axis labels
            ctx.fillStyle = '#6b7280';
            ctx.font = '12px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'top';
            const stepX = drawWidth / (weekLabels.length - 1);
            weekLabels.forEach((label, i) => {
                const x = padding.left + (i * stepX);
                ctx.fillText(label, x, canvas.height - padding.bottom + 8);
            });
            
            // Create gradient fill - red to show declining performance
            const gradient = ctx.createLinearGradient(0, padding.top, 0, canvas.height - padding.bottom);
            gradient.addColorStop(0, 'rgba(239, 68, 68, 0.2)');
            gradient.addColorStop(0.7, 'rgba(239, 68, 68, 0.1)');
            gradient.addColorStop(1, 'rgba(239, 68, 68, 0.0)');
            
            // Draw filled area
            ctx.fillStyle = gradient;
            ctx.beginPath();
            weeklyRates.forEach((rate, i) => {
                const x = padding.left + (i * stepX);
                const y = padding.top + drawHeight - ((rate - minRate) / range * drawHeight);
                if (i === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
            });
            ctx.lineTo(padding.left + (weeklyRates.length - 1) * stepX, canvas.height - padding.bottom);
            ctx.lineTo(padding.left, canvas.height - padding.bottom);
            ctx.closePath();
            ctx.fill();
            
            // Draw smooth curve
            ctx.strokeStyle = '#3b82f6';
            ctx.lineWidth = 3;
            ctx.beginPath();
            
            for (let i = 0; i < weeklyRates.length; i++) {
                const x = padding.left + (i * stepX);
                const y = padding.top + drawHeight - ((weeklyRates[i] - minRate) / range * drawHeight);
                
                if (i === 0) {
                    ctx.moveTo(x, y);
                } else if (i === weeklyRates.length - 1) {
                    ctx.lineTo(x, y);
                } else {
                    // Create smooth curve using control points
                    const xPrev = padding.left + ((i - 1) * stepX);
                    const yPrev = padding.top + drawHeight - ((weeklyRates[i - 1] - minRate) / range * drawHeight);
                    const xNext = padding.left + ((i + 1) * stepX);
                    const yNext = padding.top + drawHeight - ((weeklyRates[i + 1] - minRate) / range * drawHeight);
                    
                    const cp1x = xPrev + (x - xPrev) * 0.5;
                    const cp1y = yPrev + (y - yPrev) * 0.5;
                    const cp2x = x + (xNext - x) * 0.5;
                    const cp2y = y + (yNext - y) * 0.5;
                    
                    ctx.quadraticCurveTo(cp1x, y, x, y);
                }
            }
            ctx.stroke();
            
            // Add data points
            ctx.fillStyle = '#10b981';
            ctx.strokeStyle = 'white';
            ctx.lineWidth = 2.5;
            weeklyRates.forEach((rate, i) => {
                const x = padding.left + (i * stepX);
                const y = padding.top + drawHeight - ((rate - minRate) / range * drawHeight);
                
                // Add value labels for key points
                if (i === 0 || i === weeklyRates.length - 1 || i === 3) {
                    ctx.fillStyle = '#dc2626';
                    ctx.font = 'bold 13px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
                    ctx.textAlign = 'center';
                    ctx.textBaseline = 'bottom';
                    ctx.fillText(rate.toFixed(1) + '%', x, y - 12);
                }
                
                // Draw point
                ctx.fillStyle = '#ef4444';
                ctx.beginPath();
                ctx.arc(x, y, i === weeklyRates.length - 1 ? 7 : 5, 0, Math.PI * 2);
                ctx.fill();
                ctx.stroke();
            });
            
            // Add title and subtitle
            ctx.fillStyle = '#1e293b';
            ctx.font = 'bold 16px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
            ctx.textAlign = 'left';
            ctx.textBaseline = 'top';
            ctx.fillText('Registration Rate Trend: 26.4% ‚Üí 15.6%', padding.left, 12);
            
        }
        
        // Initialize dashboard
        function init() {
            renderAlerts();
            renderMetrics();
            populateExecutiveSummary();
            populateKPIs();
            populateDailyChanges();
            populateMilestoneTracker();
            populateRegistrationFocus();
            
            // Pre-render charts for expandable sections to avoid empty displays
            setTimeout(() => {
                if (typeof renderHistoricalChart === 'function') {
                    window.renderHistoricalChart();
                }
                if (typeof renderProjectionChart === 'function') {
                    window.renderProjectionChart();
                }
                if (typeof renderWeekPatternChart === 'function') {
                    window.renderWeekPatternChart();
                }
                if (typeof renderConversionChart === 'function') {
                    window.renderConversionChart();
                }
            }, 500);
            
            // Add placeholder charts for other sections
            window.renderHistoricalChart = function() {
                const ctx = document.getElementById('historicalChart').getContext('2d');
                if (charts.historical) charts.historical.destroy();
                
                charts.historical = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: ['Fall 2019-2020', 'Fall 2023-2024', 'Fall 2024-2025', 'Fall 2025-2026'],
                        datasets: [{
                            label: 'Total Applications (Day 47)',
                            data: [calculateTotal2019(), calculateTotal2023(), calculateLastYearTotal(), 1085], // Updated to actual total
                            borderColor: '#3b82f6',
                            backgroundColor: 'rgba(59, 130, 246, 0.1)',
                            tension: 0.4,
                            fill: true,
                            pointRadius: 6,
                            pointHoverRadius: 8
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            title: {
                                display: true,
                                text: 'Applications Trend at Day 47 - Historical Comparison'
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: 'Total Applications'
                                }
                            },
                            x: {
                                ticks: {
                                    maxRotation: 45,
                                    minRotation: 45
                                }
                            }
                        }
                    }
                });
            };
            
            window.renderProjectionChart = function() {
                const ctx = document.getElementById('projectionChart').getContext('2d');
                if (charts.projection) charts.projection.destroy();
                
                const metrics = calculateMetrics();
                
                charts.projection = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: ['Current (Day 47)', 'Projected (Day 139)', 'Target', 'Fall 2024-2025 (Day 47)'],
                        datasets: [{
                            label: 'Applications',
                            data: [metrics.total, metrics.projectedTotal, metrics.targetTotal, 1189],
                            backgroundColor: ['#3b82f6', '#fbbf24', '#10b981', '#e5e7eb'],
                            borderColor: ['#2563eb', '#f59e0b', '#059669', '#9ca3af'],
                            borderWidth: 2
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false
                            },
                            title: {
                                display: true,
                                text: 'Application Projections Based on Current Pace'
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: 'Total Applications'
                                }
                            }
                        }
                    }
                });
            };
            
            window.renderWeekPatternChart = function() {
                const ctx = document.getElementById('weekPatternChart').getContext('2d');
                if (charts.weekPattern) charts.weekPattern.destroy();
                
                const metrics = calculateMetrics();
                
                charts.weekPattern = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'],
                        datasets: [{
                            label: 'Total Applications by Day of Week (Days 1-47)',
                            data: [115, 97, 139, 98, 78, 12, 18],
                            backgroundColor: [
                                '#3b82f6', '#3b82f6', '#10b981', '#3b82f6', '#3b82f6', '#ef4444', '#ef4444'
                            ],
                            borderColor: [
                                '#2563eb', '#2563eb', '#059669', '#2563eb', '#2563eb', '#dc2626', '#dc2626'
                            ],
                            borderWidth: 2
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            title: {
                                display: true,
                                text: 'Application Pattern by Day of Week - Fall 2025-2026'
                            },
                            legend: {
                                display: false
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: 'Total Applications'
                                }
                            }
                        }
                    }
                });
            };
            
            window.renderConversionChart = function() {
                const ctx = document.getElementById('conversionChart').getContext('2d');
                if (charts.conversion) charts.conversion.destroy();
                
                // Calculate registration rates for each year at Day 45
                const regRates = {
                    '2019': calculateTotal2019() > 0 ? ((988 / calculateTotal2019()) * 100).toFixed(1) : 0,
                    '2023': calculateTotal2023() > 0 ? ((845 / calculateTotal2023()) * 100).toFixed(1) : 0,
                    '2024': calculateLastYearTotal() > 0 ? ((697 / calculateLastYearTotal()) * 100).toFixed(1) : 0,
                    '2025': 1032 > 0 ? ((109 / 1032) * 100).toFixed(1) : 0
                };
                
                charts.conversion = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: ['Fall 2019-2020', 'Fall 2023-2024', 'Fall 2024-2025', 'Fall 2025-2026'],
                        datasets: [{
                            label: 'Registration Rate % (Day 47)',
                            data: [regRates['2019'], regRates['2023'], regRates['2024'], regRates['2025']],
                            backgroundColor: ['#9ca3af', '#3b82f6', '#10b981', '#f59e0b'],
                            borderColor: ['#6b7280', '#2563eb', '#059669', '#d97706'],
                            borderWidth: 2
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            title: {
                                display: true,
                                text: 'Registration Rate Comparison at Day 47'
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: 'Registration Rate (%)'
                                },
                                ticks: {
                                    callback: function(value) {
                                        return value + '%';
                                    }
                                }
                            },
                            x: {
                                ticks: {
                                    maxRotation: 45,
                                    minRotation: 45
                                }
                            }
                        }
                    }
                });
            };
        }
        
        // Initialize on load
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>