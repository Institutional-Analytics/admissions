<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Executive Admissions Dashboard</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background-color: #f0f2f5;
            color: #1a1a1a;
            line-height: 1.6;
        }
        
        .dashboard-container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 1rem 3rem;
        }
        
        /* Header */
        .dashboard-header {
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            margin-bottom: 1rem;
        }
        
        .header-content {
            text-align: center;
        }
        
        .header-title h1 {
            font-size: 1.75rem;
            font-weight: 700;
            color: #1a1a1a;
            margin-bottom: 0.25rem;
        }
        
        .header-subtitle {
            color: #6b72188;
            font-size: 0.95rem;
        }
        
        /* Executive Summary */
        .executive-summary {
            background: linear-gradient(to bottom, #ffffff, #f8f9fa);
            padding: 2.5rem 4rem;
            border-radius: 16px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            margin: 0 auto 2rem auto;
            border: 1px solid #e5e7eb;
            width: 64.0%;
        }
        
        .summary-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
            color: #112017;
            text-align: center;
            padding-bottom: 1rem;
            position: relative;
            width: 100%;
        }
        
        .summary-title::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 60px;
            height: 3px;
            background: linear-gradient(90deg, #3b82f6, #8b5cf6);
            border-radius: 2px;
        }
        
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(4, minmax(250px, 1fr));
            gap: 2rem;
            width: 100%;
            margin: 0 auto;
        }
        
        .summary-row-header {
            grid-column: 1 / -1;
            font-size: 0.875rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.75px;
            color: #6b72188;
            padding: 0.75rem 0;
            margin: 0.5rem 0;
            border-bottom: 2px solid #e5e7eb;
            text-align: center;
        }
        
        .summary-card {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            border: 1px solid #e5e7eb;
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
            height: 100%;
            display: flex;
            flex-direction: column;
            min-height: 160px;
        }
        
        .summary-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            border-color: #d1d5db;
        }
        
        .summary-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
        }
        
        /* Application cards (positions 2-5) */
        .summary-card:nth-child(2)::before { 
            background: linear-gradient(90deg, #f59e0b, #fbbf24); 
        }
        .summary-card:nth-child(3)::before { 
            background: linear-gradient(90deg, #ef4444, #f87171); 
        }
        .summary-card:nth-child(4)::before { 
            background: linear-gradient(90deg, #ef4444, #f87171); 
        }
        .summary-card:nth-child(5)::before { 
            background: linear-gradient(90deg, #3b82f6, #60a5fa); 
        }
        
        /* Registration cards (positions 7-10) */
        .summary-card:nth-child(7)::before { 
            background: linear-gradient(90deg, #8b5cf6, #a78bfa); 
        }
        .summary-card:nth-child(8)::before { 
            background: linear-gradient(90deg, #ec4899, #f472b6); 
        }
        .summary-card:nth-child(9)::before { 
            background: linear-gradient(90deg, #ec4899, #f472b6); 
        }
        .summary-card:nth-child(10)::before { 
            background: linear-gradient(90deg, #14b8a6, #5eead4); 
        }
        
        .summary-content {
            display: flex;
            flex-direction: column;
            height: 100%;
        }
        
        .summary-label {
            font-size: 0.8125rem;
            color: #6b72188;
            margin-bottom: 1rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-weight: 600;
            text-align: left;
        }
        
        .summary-main {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        
        .summary-value {
            font-size: 2.5rem;
            font-weight: 1880;
            line-height: 1;
            margin-bottom: 0.5rem;
            letter-spacing: -1px;
        }
        
        .summary-value.positive { color: #059669; }
        .summary-value.negative { color: #dc2626; }
        .summary-value.warning { color: #d97706; }
        .summary-value.neutral { color: #2563eb; }
        
        .summary-detail {
            font-size: 0.875rem;
            color: #4b5563;
            line-height: 1.5;
            text-align: center;
        }
        
        @media (max-width: 1400px) {
            .summary-grid {
                grid-template-columns: repeat(4, minmax(200px, 1fr));
                gap: 1.5rem;
            }
        }
        
        @media (max-width: 1100px) {
            .summary-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 1.5rem;
            }
        }
        
        @media (max-width: 640px) {
            .summary-grid {
                grid-template-columns: 1fr;
            }
            
            .summary-title {
                font-size: 1.25rem;
            }
            
            .summary-value {
                font-size: 2rem;
            }
        }
        
        /* Cycle Progress Bar */
        .cycle-progress-section {
            background: linear-gradient(to bottom, #ffffff, #f8f9fa);
            padding: 2.5rem 4rem;
            border-radius: 16px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            margin: 0 auto 2rem auto;
            border: 1px solid #e5e7eb;
            position: relative;
            overflow: hidden;
            width: 95%;
        }
        
        .cycle-progress-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #3b82f6, #8b5cf6);
        }
        
        .cycle-header {
            text-align: center;
            margin-bottom: 2rem;
        }
        
        .cycle-header h2 {
            font-size: 1.5rem;
            font-weight: 700;
            margin: 0 0 1rem 0;
            color: #112017;
        }
        
        .cycle-stats {
            display: flex;
            justify-content: center;
            gap: 2rem;
            flex-wrap: wrap;
        }
        
        .cycle-stat {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.25rem;
        }
        
        .cycle-stat-value {
            font-size: 1.875rem;
            font-weight: 1880;
            color: #1f2937;
            letter-spacing: -0.5px;
        }
        
        .cycle-stat-label {
            font-size: 0.875rem;
            color: #6b72188;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-weight: 600;
        }
        
        .progress-visual {
            margin: 2rem 0;
        }
        
        .progress-bar-container {
            background: #f3f4f6;
            height: 48px;
            border-radius: 24px;
            overflow: hidden;
            position: relative;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.06);
        }
        
        .progress-bar-fill {
            background: linear-gradient(90deg, #3b82f6, #6366f1);
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }
        
        .progress-bar-fill::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            animation: shimmer 2s infinite;
        }
        
        @keyframes shimmer {
            100% {
                left: 100%;
            }
        }
        
        .progress-label {
            color: white !important;
            font-weight: 1880;
            font-size: 1.125rem;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3), 0 1px 2px rgba(0, 0, 0, 0.4);
            z-index: 1;
            position: relative;
            letter-spacing: 0.5px;
        }
        
        .cycle-dates {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            margin-top: 1.5rem;
        }
        
        .cycle-date-item {
            text-align: center;
            padding: 1rem;
            background: white;
            border-radius: 12px;
            border: 1px solid #e5e7eb;
        }
        
        .cycle-date-label {
            font-size: 0.75rem;
            color: #6b72188;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-weight: 600;
            margin-bottom: 0.5rem;
            display: block;
        }
        
        .cycle-date-value {
            font-size: 1rem;
            font-weight: 700;
            color: #1f2937;
        }
        
        @media (max-width: 768px) {
            .cycle-stats {
                gap: 1rem;
            }
            
            .cycle-dates {
                grid-template-columns: 1fr;
                gap: 0.75rem;
            }
            
            .progress-bar-container {
                height: 40px;
            }
        }
        
        /* Daily Changes Section */
        .daily-changes-section {
            background: linear-gradient(to bottom, #ffffff, #f8f9fa);
            padding: 2.5rem 4rem;
            border-radius: 16px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            margin: 0 auto 2rem auto;
            border: 1px solid #e5e7eb;
            position: relative;
            overflow: hidden;
            width: 95%;
        }
        
        .daily-changes-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #10b981, #34d399);
        }
        
        .daily-changes-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 2rem;
            color: #112017;
            text-align: center;
            padding-bottom: 1rem;
            position: relative;
        }
        
        .daily-changes-title::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 60px;
            height: 3px;
            background: linear-gradient(90deg, #10b981, #34d399);
            border-radius: 2px;
        }
        
        .changes-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 2rem;
            width: 100%;
            margin: 0 auto;
        }
        
        .change-card {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            border: 1px solid #e5e7eb;
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
            height: 100%;
            display: flex;
            flex-direction: column;
        }
        
        .change-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            border-color: #d1d5db;
        }
        
        .change-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
        }
        
        .change-card:nth-child(1)::before { 
            background: linear-gradient(90deg, #3b82f6, #60a5fa); 
        }
        .change-card:nth-child(2)::before { 
            background: linear-gradient(90deg, #10b981, #34d399); 
        }
        .change-card:nth-child(3)::before { 
            background: linear-gradient(90deg, #8b5cf6, #a78bfa); 
        }
        
        .change-header {
            text-align: center;
            margin-bottom: 1.5rem;
        }
        
        .change-label {
            font-size: 0.8125rem;
            color: #6b72188;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-weight: 600;
            margin-bottom: 1rem;
            display: block;
        }
        
        .change-value {
            font-size: 2.5rem;
            font-weight: 1880;
            color: #1f2937;
            line-height: 1;
            letter-spacing: -1px;
        }
        
        .change-value.positive {
            color: #059669;
        }
        
        .change-value.negative {
            color: #dc2626;
        }
        
        .change-detail {
            font-size: 0.875rem;
            color: #4b5563;
            margin-bottom: 1rem;
            text-align: center;
            line-height: 1.5;
        }
        
        .change-breakdown {
            font-size: 0.8125rem;
            color: #6b72188;
            margin-top: auto;
            padding-top: 1rem;
            border-top: 1px solid #e5e7eb;
            text-align: center;
            background: #f9fafb;
            margin-left: -2rem;
            margin-right: -2rem;
            margin-bottom: -2rem;
            padding: 1rem 2rem;
            border-radius: 0 0 12px 12px;
        }
        
        @media (max-width: 1100px) {
            .changes-grid {
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }
        }
        
        /* Milestone Section */
        .milestone-section {
            background: linear-gradient(to bottom, #ffffff, #f8f9fa);
            padding: 2.5rem 4rem;
            border-radius: 16px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            margin: 0 auto 2rem auto;
            border: 1px solid #e5e7eb;
            position: relative;
            overflow: hidden;
            width: 95%;
        }
        
        .milestone-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #3b82f6, #06b6d4, #10b981);
        }
        
        .milestone-title-container {
            text-align: center;
            margin-bottom: 2rem;
        }
        
        .milestone-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 0.5rem;
        }
        
        .milestone-title-underline {
            width: 60px;
            height: 3px;
            background: linear-gradient(90deg, #3b82f6, #06b6d4);
            margin: 0 auto;
            border-radius: 2px;
            margin-bottom: 1.5rem;
            color: #1a1a1a;
        }
        
        .milestone-container {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 2rem;
        }
        
        .next-milestone-card {
            background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%);
            padding: 1.5rem;
            border-radius: 12px;
            border: 1px solid #bfdbfe;
        }
        
        .milestone-header {
            display: flex;
            justify-content: space-between;
            align-items: baseline;
            margin-bottom: 0.75rem;
        }
        
        .milestone-label {
            font-size: 0.875rem;
            color: #1e40af;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .milestone-value {
            font-size: 2rem;
            font-weight: 700;
            color: #1e40af;
        }
        
        .milestone-detail {
            font-size: 0.875rem;
            color: #3730a3;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .milestone-separator {
            color: #60a5fa;
        }
        
        .milestone-progress-bar {
            background: #dbeafe;
            height: 24px;
            border-radius: 12px;
            overflow: hidden;
            position: relative;
        }
        
        .milestone-progress-fill {
            background: linear-gradient(90deg, #3b82f6 0%, #2563eb 100%);
            height: 100%;
            transition: width 0.5s ease;
        }
        
        /* Milestone progress label removed - now displayed above bar */
        
        .all-milestones {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 1rem;
        }
        
        .milestone-item {
            background: #f8f9fa;
            padding: 1rem;
            border-radius: 8px;
            border: 1px solid #e5e7eb;
            text-align: center;
        }
        
        .milestone-item.final {
            background: #fef3c7;
            border-color: #fde68a;
        }
        
        .milestone-item.achieved {
            background: #d1fae5;
            border-color: #a7f3d0;
        }
        
        /* Registration Focus Section */
        .registration-focus-section {
            background: linear-gradient(to bottom, #ffffff, #f8f9fa);
            padding: 2.5rem 4rem;
            border-radius: 16px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            margin: 0 auto 2rem auto;
            border: 1px solid #e5e7eb;
            position: relative;
            overflow: hidden;
            width: 95%;
        }
        
        .registration-focus-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #dc2626, #ea5188c, #d97706);
        }
        
        .registration-title-container {
            text-align: center;
            margin-bottom: 2rem;
        }
        
        .registration-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 0.5rem;
        }
        
        .registration-title-underline {
            width: 60px;
            height: 3px;
            background: linear-gradient(90deg, #dc2626, #ea5188c);
            margin: 0 auto;
            border-radius: 2px;
        }
        
        /* KPI Section */
        .kpi-section {
            background: linear-gradient(to bottom, #ffffff, #f8f9fa);
            padding: 2.5rem 4rem;
            border-radius: 16px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            margin: 0 auto 2rem auto;
            border: 1px solid #e5e7eb;
            position: relative;
            overflow: hidden;
            width: 95%;
        }
        
        .kpi-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #7c3aed, #a855f7, #c084fc);
        }
        
        .kpi-title-container {
            text-align: center;
            margin-bottom: 2rem;
        }
        
        .kpi-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 0.5rem;
        }
        
        .kpi-title-underline {
            width: 60px;
            height: 3px;
            background: linear-gradient(90deg, #7c3aed, #a855f7);
            margin: 0 auto;
            border-radius: 2px;
            margin-bottom: 1.5rem;
        }
        
        .kpi-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
        }
        
        .kpi-card {
            display: flex;
            align-items: center;
            background: #f8f9fa;
            padding: 1.25rem;
            border-radius: 10px;
            gap: 1rem;
        }
        
        .kpi-icon {
            font-size: 2rem;
            opacity: 0.8;
        }
        
        .kpi-content {
            flex: 1;
        }
        
        .kpi-label {
            font-size: 0.875rem;
            color: #6b72188;
            margin-bottom: 0.25rem;
        }
        
        .kpi-value {
            font-size: 1.5rem;
            font-weight: 700;
            line-height: 1.2;
        }
        
        .kpi-trend {
            font-size: 0.75rem;
            margin-top: 0.25rem;
        }
        
        .kpi-trend.positive { color: #10b981; }
        .kpi-trend.negative { color: #ef4444; }
        
        /* Alerts Section */
        .alerts-section {
            background: linear-gradient(to bottom, #ffffff, #f8f9fa);
            padding: 2.5rem 4rem;
            border-radius: 16px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            margin: 0 auto 2rem auto;
            border: 1px solid #e5e7eb;
            position: relative;
            overflow: hidden;
            width: 95%;
        }
        
        .alerts-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #f59e0b, #eab308, #84cc16);
        }
        
        .alerts-title-container {
            text-align: center;
            margin-bottom: 2rem;
        }
        
        .alerts-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 0.5rem;
        }
        
        .alerts-title-underline {
            width: 60px;
            height: 3px;
            background: linear-gradient(90deg, #f59e0b, #eab308);
            margin: 0 auto;
            border-radius: 2px;
        }
        
        .alerts-header {
            display: none;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }
        
        .alert-icon {
            width: 24px;
            height: 24px;
            background: #ef4444;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 14px;
        }
        
        .alerts-title {
            font-size: 1.125rem;
            font-weight: 600;
        }
        
        .alert-item {
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
            padding: 0.75rem 0;
            border-bottom: 1px solid #f3f4f6;
        }
        
        .alert-item:last-child {
            border-bottom: none;
        }
        
        .alert-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-top: 0.5rem;
            flex-shrink: 0;
        }
        
        .alert-indicator.high { background: #ef4444; }
        .alert-indicator.warning { background: #f59e0b; }
        .alert-indicator.positive { background: #10b981; }
        .alert-indicator.info { background: #3b82f6; }
        
        .alert-content {
            flex: 1;
        }
        
        .alert-message {
            font-size: 0.95rem;
            margin-bottom: 0.25rem;
        }
        
        .alert-detail {
            font-size: 0.875rem;
            color: #6b72188;
        }
        
        /* Metrics Section */
        .metrics-section {
            background: linear-gradient(to bottom, #ffffff, #f8f9fa);
            padding: 2.5rem 4rem;
            border-radius: 16px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            margin: 0 auto 2rem auto;
            border: 1px solid #e5e7eb;
            position: relative;
            overflow: hidden;
            width: 95%;
        }
        
        .metrics-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #059669, #0d9488, #0891b2);
        }
        
        .metrics-title-container {
            text-align: center;
            margin-bottom: 2rem;
        }
        
        .metrics-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 0.5rem;
        }
        
        .metrics-title-underline {
            width: 60px;
            height: 3px;
            background: linear-gradient(90deg, #059669, #0d9488);
            margin: 0 auto;
            border-radius: 2px;
        }
        
        .metrics-header {
            display: flex;
            justify-content: center;
            margin-bottom: 2rem;
            align-items: center;
            margin-bottom: 1.5rem;
        }
        
        .metrics-title {
            font-size: 1.125rem;
            font-weight: 600;
        }
        
        .view-toggle {
            display: flex;
            background: #f3f4f6;
            border-radius: 8px;
            padding: 0.25rem;
        }
        
        .view-toggle button {
            padding: 0.5rem 1rem;
            border: none;
            background: transparent;
            color: #6b72188;
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            border-radius: 6px;
            transition: all 0.2s;
        }
        
        .view-toggle button.active {
            background: white;
            color: #1a1a1a;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        
        /* Charts */
        .chart-container {
            position: relative;
            height: 300px;
            margin: 1rem 0;
        }
        
        .chart-container.small {
            height: 200px;
        }
        
        .chart-container.large {
            height: 500px;
        }
        
        /* Expandable Sections */
        .expandable-section {
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            margin-bottom: 1.5rem;
            overflow: hidden;
        }
        
        .expandable-header {
            padding: 1.5rem;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background-color 0.2s;
        }
        
        .expandable-header:hover {
            background-color: #f8f9fa;
        }
        
        .expandable-title {
            font-size: 1.125rem;
            font-weight: 600;
        }
        
        .expand-icon {
            width: 24px;
            height: 24px;
            transition: transform 0.3s;
        }
        
        .expandable-header.expanded .expand-icon {
            transform: rotate(271deg);
        }
        
        .expandable-content {
            padding: 0 1.5rem;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out, padding 0.3s ease-out;
        }
        
        .expandable-content.expanded {
            max-height: 2000px;
            padding: 0 1.5rem 1.5rem 1.5rem;
        }
        
        /* Tables */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
        }
        
        .data-table th {
            background: #f8f9fa;
            padding: 0.75rem;
            text-align: left;
            font-weight: 600;
            font-size: 0.875rem;
            border-bottom: 2px solid #e5e7eb;
        }
        
        .data-table td {
            padding: 0.75rem;
            border-bottom: 1px solid #f3f4f6;
            font-size: 0.875rem;
        }
        
        .data-table tr:hover {
            background: #f8f9fa;
        }
        
        /* Divider styles */
        .section-divider {
            height: 1px;
            background: linear-gradient(to right, transparent, #e5e7eb 20%, #e5e7eb 188%, transparent);
            margin: 2rem 0;
        }
        
        .chart-divider {
            height: 1px;
            background: #e5e7eb;
            margin: 2rem 0;
        }
        
        /* Campus Grid */
        .campus-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }
        
        .campus-card {
            background: #f9fafb;
            padding: 1.25rem;
            border-radius: 8px;
            border: 1px solid #e5e7eb;
        }
        
        .campus-card h3 {
            font-size: 1.125rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: #1f2937;
        }
        
        .campus-metrics {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        
        .metric-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.25rem 0;
        }
        
        .metric-label {
            font-size: 0.875rem;
            color: #6b72188;
        }
        
        .metric-value {
            font-size: 0.875rem;
            font-weight: 600;
            color: #1f2937;
        }
        
        /* Chart Divider */
        .chart-divider {
            height: 1px;
            background: #e5e7eb;
            margin: 2rem 0;
        }
        
        /* Historical Comparison Sections */
        .historical-comparison-section {
            background: linear-gradient(to bottom, #ffffff, #f8f9fa);
            padding: 2rem;
            border-radius: 16px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            margin: 2rem auto;
            border: 1px solid #e5e7eb;
            width: 95%;
        }
        
        .historical-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
            color: #112017;
            text-align: center;
            padding-bottom: 1rem;
            position: relative;
        }
        
        .historical-title::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 60px;
            height: 3px;
            background: linear-gradient(90deg, #3b82f6, #8b5cf6);
            border-radius: 2px;
        }
        
        .comparison-grid {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 2rem;
            margin-top: 2rem;
        }
        
        .year-bars-container {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        
        .year-bar-item {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .year-label {
            font-weight: 600;
            color: #374151;
            min-width: 100px;
            font-size: 0.95rem;
        }
        
        .year-bar-wrapper {
            flex: 1;
            position: relative;
        }
        
        .year-bar-bg {
            height: 36px;
            background: #f3f4f6;
            border-radius: 8px;
            overflow: hidden;
            position: relative;
        }
        
        .year-bar-fill {
            height: 100%;
            border-radius: 8px;
            display: flex;
            align-items: center;
            padding: 0 12px;
            color: white;
            font-weight: 600;
            font-size: 0.875rem;
            transition: width 0.6s ease;
        }
        
        .year-bar-fill.current-year {
            background: linear-gradient(90deg, #3b82f6, #60a5fa);
            position: relative;
        }
        
        .year-bar-fill.current-year::after {
            content: '';
            position: absolute;
            right: 0;
            top: 0;
            bottom: 0;
            width: 4px;
            background: #1e40af;
            animation: pulse 2s infinite;
        }
        
        .year-bar-fill.past-year-2024 {
            background: linear-gradient(90deg, #8b5cf6, #a78bfa);
        }
        
        .year-bar-fill.past-year-2023 {
            background: linear-gradient(90deg, #ec4899, #f472b6);
        }
        
        .year-bar-fill.past-year-2019 {
            background: linear-gradient(90deg, #f59e0b, #fbbf24);
        }
        
        .comparison-stats {
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            border: 1px solid #e5e7eb;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1.5rem;
        }
        
        .stat-item {
            text-align: center;
            padding: 1rem;
            background: #f9fafb;
            border-radius: 8px;
        }
        
        .stat-label {
            font-size: 0.875rem;
            color: #6b72188;
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .stat-value {
            font-size: 1.75rem;
            font-weight: 700;
            color: #1f2937;
        }
        
        .stat-detail {
            font-size: 0.75rem;
            color: #9ca3af;
            margin-top: 0.25rem;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        /* Utility Classes */
        .text-positive { color: #10b981; }
        .text-negative { color: #ef4444; }
        .text-muted { color: #6b72188; }
        
        /* Mobile Responsive */
        @media (max-width: 768px) {
            .dashboard-container {
                padding: 0.5rem;
            }
            
            .metrics-grid {
                grid-template-columns: 1fr;
            }
            
            .milestone-container {
                grid-template-columns: 1fr;
            }
            
            .all-milestones {
                grid-template-columns: repeat(2, 1fr);
            }
        }
            /* Enhanced Expandable Sections Styles */
        
        /* Campus Performance Grid */
        .campus-performance-grid {
            display: flex;
            flex-direction: column;
            gap: 2rem;
            padding: 1rem 0;
        }
        
        .performance-section {
            background: #f9fafb;
            padding: 1.5rem;
            border-radius: 12px;
            border: 1px solid #e5e7eb;
        }
        
        .section-subtitle {
            font-size: 1.125rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
            color: #1f2937;
        }
        
        .campus-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(2188px, 1fr));
            gap: 1rem;
        }
        
        .campus-card {
            background: white;
            padding: 1.5rem;
            border-radius: 10px;
            border: 1px solid #e5e7eb;
            transition: all 0.2s ease;
        }
        
        .campus-card.top-performer {
            border-color: #10b981;
            box-shadow: 0 0 0 1px #10b981;
        }
        
        .campus-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }
        
        .campus-header h4 {
            margin: 0;
            font-size: 1.125rem;
            font-weight: 600;
        }
        
        .badge {
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
        }
        
        .badge-success {
            background: #10b981;
            color: white;
        }
        
        .badge-warning {
            background: #f59e0b;
            color: white;
        }
        
        .campus-stats {
            margin-bottom: 1rem;
        }
        
        .stat-row {
            display: flex;
            justify-content: space-between;
            align-items: baseline;
            margin-bottom: 0.5rem;
        }
        
        .stat-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: #1f2937;
        }
        
        .stat-label {
            font-size: 0.875rem;
            color: #6b72188;
        }
        
        .progress-mini {
            height: 6px;
            background: #e5e7eb;
            border-radius: 3px;
            overflow: hidden;
            margin-top: 0.5rem;
        }
        
        .progress-mini .progress-fill {
            height: 100%;
            background: #3b82f6;
        }
        
        .campus-metrics {
            display: flex;
            gap: 1rem;
            padding-top: 0.75rem;
            border-top: 1px solid #e5e7eb;
        }
        
        .metric-item {
            flex: 1;
            text-align: center;
        }
        
        .metric-value.negative {
            color: #ef4444;
        }
        
        .metric-value.positive {
            color: #10b981;
        }
        
        /* Risk Indicators */
        .risk-indicators {
            display: grid;
            gap: 1rem;
        }
        
        .risk-card {
            background: white;
            padding: 1.25rem;
            border-radius: 10px;
            border: 1px solid #fee2e2;
            border-left: 4px solid #ef4444;
        }
        
        .risk-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.75rem;
        }
        
        .risk-header h4 {
            margin: 0;
            font-size: 1rem;
            font-weight: 600;
        }
        
        .risk-badge {
            padding: 0.25rem 0.5rem;
            border-radius: 6px;
            font-size: 0.875rem;
            font-weight: 700;
        }
        
        .risk-badge.critical {
            background: #fee2e2;
            color: #dc2626;
        }
        
        .risk-badge.warning {
            background: #fef3c7;
            color: #d97706;
        }
        
        .risk-details p {
            margin: 0.5rem 0;
            font-size: 0.875rem;
            color: #4b5563;
        }
        
        .action-needed {
            font-size: 0.875rem;
            color: #dc2626;
            font-weight: 600;
            margin-top: 0.5rem;
        }
        
        /* Campus Summary */
        .campus-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 2rem;
        }
        
        .summary-card {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background: white;
            border-radius: 10px;
            border: 1px solid #e5e7eb;
        }
        
        .summary-icon {
            font-size: 2rem;
        }
        
        .summary-content {
            flex: 1;
        }
        
        /* Trends Container */
        .trends-container {
            padding: 1rem 0;
        }
        
        .projection-insights {
            margin-top: 2rem;
            background: #f9fafb;
            padding: 1.5rem;
            border-radius: 12px;
            border: 1px solid #e5e7eb;
        }
        
        .insights-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
        }
        
        .insight-card {
            background: white;
            padding: 1.5rem;
            border-radius: 10px;
            border: 1px solid #e5e7eb;
        }
        
        .insight-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1rem;
        }
        
        .insight-icon {
            font-size: 1.5rem;
        }
        
        .insight-header h4 {
            margin: 0;
            font-size: 1rem;
            font-weight: 600;
            color: #4b5563;
        }
        
        .insight-value {
            font-size: 2.5rem;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 0.5rem;
        }
        
        .insight-detail {
            font-size: 0.875rem;
            color: #6b72188;
        }
        
        .insight-detail .negative {
            color: #ef4444;
        }
        
        .insight-detail .positive {
            color: #10b981;
        }
        
        .insight-progress {
            margin-top: 1rem;
        }
        
        .progress-bar-sm {
            height: 8px;
            background: #e5e7eb;
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 0.5rem;
        }
        
        .progress-bar-sm .progress-fill {
            height: 100%;
            background: #f59e0b;
        }
        
        .progress-label {
            font-size: 0.75rem;
            color: #6b72188;
        }
        
        .daily-trend {
            height: 188px;
            margin-top: 1rem;
        }
        
        .scenarios {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }
        
        .scenario {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.5rem;
            background: #f9fafb;
            border-radius: 6px;
        }
        
        .scenario-label {
            font-size: 0.875rem;
            color: #6b72188;
        }
        
        .scenario-value {
            font-size: 1rem;
            font-weight: 600;
            color: #1f2937;
        }
        
        /* YoY Matrix */
        .yoy-matrix {
            margin-top: 2rem;
            background: #f9fafb;
            padding: 1.5rem;
            border-radius: 12px;
            border: 1px solid #e5e7eb;
        }
        
        .matrix-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr 1fr;
            gap: 1px;
            background: #e5e7eb;
            border-radius: 8px;
            overflow: hidden;
        }
        
        .matrix-cell {
            background: white;
            padding: 1rem;
            text-align: center;
            font-size: 0.875rem;
        }
        
        .matrix-cell.header {
            background: #f3f4f6;
            font-weight: 600;
            color: #4b5563;
        }
        
        .matrix-cell.value {
            font-weight: 700;
            font-size: 1rem;
            color: #1f2937;
        }
        
        .matrix-cell.value.current {
            background: #fef3c7;
        }
        
        .matrix-cell.negative {
            color: #ef4444;
        }
        
        .trend-indicator {
            font-size: 1.25rem;
        }
        
        .trend-indicator.down {
            color: #ef4444;
        }
        
        .trend-indicator.stable {
            color: #6b72188;
        }
        
        /* Analytics Container */
        .analytics-container {
            padding: 1rem 0;
        }
        
        /* Funnel Visualization */
        .funnel-section {
            background: #f9fafb;
            padding: 1.5rem;
            border-radius: 12px;
            border: 1px solid #e5e7eb;
            margin-bottom: 2rem;
        }
        
        .funnel-visualization {
            margin: 1.5rem 0;
        }
        
        .funnel-stage {
            margin-bottom: 1rem;
        }
        
        .funnel-bar {
            background: #3b82f6;
            color: white;
            padding: 1rem;
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: 600;
            transition: width 0.3s ease;
        }
        
        .funnel-bar.registered {
            background: #10b981;
        }
        
        .funnel-bar.projected {
            background: #f59e0b;
            border: 2px dashed #d97706;
        }
        
        .funnel-insights {
            display: flex;
            gap: 2rem;
            margin-top: 1.5rem;
            padding-top: 1rem;
            border-top: 1px solid #e5e7eb;
        }
        
        .funnel-metric {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        /* Executive KPIs */
        .executive-kpis {
            margin-bottom: 2rem;
        }
        
        .kpi-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
        }
        
        .kpi-card {
            display: flex;
            align-items: flex-start;
            gap: 1rem;
            padding: 1.5rem;
            background: white;
            border-radius: 10px;
            border: 1px solid #e5e7eb;
            border-left: 4px solid #e5e7eb;
        }
        
        .kpi-card.critical {
            border-left-color: #ef4444;
            background: #fef2f2;
        }
        
        .kpi-card.warning {
            border-left-color: #f59e0b;
            background: #fffbeb;
        }
        
        .kpi-card.success {
            border-left-color: #10b981;
            background: #f0fdf4;
        }
        
        .kpi-card.info {
            border-left-color: #3b82f6;
            background: #eff6ff;
        }
        
        .kpi-icon {
            font-size: 1.5rem;
        }
        
        .kpi-content {
            flex: 1;
        }
        
        .kpi-title {
            font-size: 0.875rem;
            font-weight: 600;
            color: #4b5563;
            margin-bottom: 0.25rem;
        }
        
        .kpi-value {
            font-size: 1.75rem;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 0.25rem;
        }
        
        .kpi-detail {
            font-size: 0.75rem;
            color: #6b72188;
        }
        
        /* Pattern Analysis */
        .pattern-analysis {
            background: #f9fafb;
            padding: 1.5rem;
            border-radius: 12px;
            border: 1px solid #e5e7eb;
            margin-bottom: 2rem;
        }
        
        .pattern-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            align-items: center;
        }
        
        .pattern-chart {
            height: 300px;
        }
        
        .pattern-insights h4 {
            margin-bottom: 1rem;
            font-size: 1rem;
            font-weight: 600;
        }
        
        .insight-list {
            list-style: none;
            padding: 0;
            margin: 0 0 1.5rem 0;
        }
        
        .insight-list li {
            padding: 0.5rem 0;
            font-size: 0.875rem;
            color: #4b5563;
        }
        
        .recommendation-box {
            background: #fef3c7;
            padding: 1rem;
            border-radius: 8px;
            border: 1px solid #fbbf24;
        }
        
        .recommendation-box h4 {
            margin: 0 0 0.5rem 0;
            font-size: 0.875rem;
            font-weight: 600;
            color: #92400e;
        }
        
        .recommendation-box p {
            margin: 0;
            font-size: 0.875rem;
            color: #78350f;
        }
        
        /* Decision Matrix */
        .decision-matrix {
            margin-top: 2rem;
        }
        
        .decision-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1rem;
        }
        
        .decision-item {
            display: flex;
            align-items: flex-start;
            gap: 1rem;
            padding: 1.5rem;
            background: white;
            border-radius: 10px;
            border: 1px solid #e5e7eb;
        }
        
        .decision-icon {
            font-size: 2rem;
        }
        
        .decision-content h4 {
            margin: 0 0 0.5rem 0;
            font-size: 1rem;
            font-weight: 600;
        }
        
        .decision-content p {
            margin: 0 0 1rem 0;
            font-size: 0.875rem;
            color: #6b72188;
        }
        
        .action-btn {
            padding: 0.5rem 1rem;
            background: #3b82f6;
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: background 0.2s ease;
        }
        
        .action-btn:hover {
            background: #2563eb;
        }
        
        /* Responsive adjustments */
        @media (max-width: 768px) {
            .pattern-grid {
                grid-template-columns: 1fr;
            }
            
            .matrix-grid {
                font-size: 0.75rem;
            }
            
            .matrix-cell {
                padding: 0.5rem;
            }
        }
            /* Clean Expandable Section Styles */
        
        /* Campus Comparison Grid */
        .campus-comparison-grid {
            padding: 1rem 0;
        }
        
        .comparison-table {
            margin: 1rem 0 2rem 0;
            overflow-x: auto;
        }
        
        .campus-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            font-size: 0.9rem;
        }
        
        .campus-table th {
            background: #f3f4f6;
            padding: 0.75rem;
            text-align: left;
            font-weight: 600;
            color: #374151;
            border-bottom: 2px solid #e5e7eb;
        }
        
        .campus-table td {
            padding: 0.75rem;
            border-bottom: 1px solid #e5e7eb;
        }
        
        .campus-table .campus-name {
            font-weight: 600;
            color: #1f2937;
        }
        
        .campus-table .total-row {
            font-weight: 700;
            background: #f9fafb;
            border-top: 2px solid #e5e7eb;
        }
        
        .campus-insights {
            background: #f9fafb;
            padding: 1.5rem;
            border-radius: 8px;
            margin-top: 2rem;
        }
        
        .campus-insights h4 {
            margin: 0 0 1rem 0;
            font-size: 1.125rem;
            font-weight: 600;
        }
        
        .insight-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
        }
        
        .insight-box {
            background: white;
            padding: 1.25rem;
            border-radius: 6px;
            border: 1px solid #e5e7eb;
        }
        
        .insight-box h5 {
            margin: 0 0 0.5rem 0;
            font-size: 0.875rem;
            font-weight: 600;
            color: #6b72188;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        
        .insight-box p {
            margin: 0.25rem 0;
            font-size: 0.9rem;
            color: #374151;
        }
        
        .insight-box strong {
            color: #1f2937;
        }
        
        /* Trends Container Clean */
        .chart-section {
            margin-bottom: 2rem;
        }
        
        .chart-section h3 {
            margin-bottom: 1rem;
        }
        
        .trend-summary {
            background: #f9fafb;
            padding: 1.5rem;
            border-radius: 8px;
            margin-bottom: 2rem;
        }
        
        .trend-summary h4 {
            margin: 0 0 1rem 0;
            font-size: 1.125rem;
            font-weight: 600;
        }
        
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
        }
        
        .summary-item {
            background: white;
            padding: 1rem;
            border-radius: 6px;
            border: 1px solid #e5e7eb;
            text-align: center;
        }
        
        .summary-item.current {
            border-color: #f59e0b;
            background: #fffbeb;
        }
        
        .year-label {
            font-size: 0.875rem;
            font-weight: 600;
            color: #6b72188;
            margin-bottom: 0.25rem;
        }
        
        .year-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 0.25rem;
        }
        
        .year-change {
            font-size: 0.8rem;
            color: #6b72188;
        }
        
        .projection-section {
            background: white;
            padding: 1.5rem;
            border-radius: 8px;
            border: 1px solid #e5e7eb;
        }
        
        .projection-section h4 {
            margin: 0 0 1rem 0;
            font-size: 1.125rem;
            font-weight: 600;
        }
        
        .projection-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }
        
        .projection-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem;
            background: #f9fafb;
            border-radius: 4px;
        }
        
        .projection-label {
            font-size: 0.875rem;
            color: #6b72188;
        }
        
        .projection-value {
            font-size: 1rem;
            font-weight: 600;
            color: #1f2937;
        }
        
        /* Analytics Clean Styles */
        .flow-section {
            background: #f9fafb;
            padding: 1.5rem;
            border-radius: 8px;
            margin-bottom: 2rem;
        }
        
        .flow-section h3 {
            margin: 0 0 1.5rem 0;
        }
        
        .flow-visualization {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1rem;
            flex-wrap: wrap;
        }
        
        .flow-item {
            background: white;
            padding: 1.5rem;
            border-radius: 8px;
            border: 2px solid #e5e7eb;
            text-align: center;
            min-width: 140px;
        }
        
        .flow-item.applications {
            border-color: #3b82f6;
        }
        
        .flow-item.registered {
            border-color: #10b981;
        }
        
        .flow-item.projected {
            border-color: #f59e0b;
            border-style: dashed;
        }
        
        .flow-number {
            font-size: 1.75rem;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 0.25rem;
        }
        
        .flow-label {
            font-size: 0.875rem;
            color: #6b72188;
        }
        
        .flow-arrow {
            font-size: 1.5rem;
            color: #9ca3af;
        }
        
        .weekly-section {
            margin-bottom: 2rem;
        }
        
        .weekly-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            align-items: start;
        }
        
        .chart-container.medium {
            height: 300px;
        }
        
        .weekly-stats {
            background: #f9fafb;
            padding: 1.5rem;
            border-radius: 8px;
        }
        
        .weekly-stats h4 {
            margin: 0 0 1rem 0;
            font-size: 1.125rem;
            font-weight: 600;
        }
        
        .stats-list {
            list-style: none;
            padding: 0;
            margin: 0 0 1rem 0;
        }
        
        .stats-list li {
            padding: 0.5rem 0;
            border-bottom: 1px solid #e5e7eb;
            font-size: 0.9rem;
            color: #374151;
        }
        
        .weekly-insight {
            margin-top: 1rem;
            padding: 1rem;
            background: #fffbeb;
            border-radius: 6px;
            font-size: 0.9rem;
        }
        
        .metrics-dashboard {
            background: white;
            padding: 1.5rem;
            border-radius: 8px;
            border: 1px solid #e5e7eb;
        }
        
        .metrics-dashboard h3 {
            margin: 0 0 1.5rem 0;
        }
        
        .kpi-grid-simple {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
        }
        
        .kpi-item {
            text-align: center;
            padding: 1.25rem;
            background: #f9fafb;
            border-radius: 6px;
        }
        
        .kpi-label {
            font-size: 0.875rem;
            font-weight: 600;
            color: #6b72188;
            margin-bottom: 0.5rem;
        }
        
        .kpi-value {
            font-size: 2rem;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 0.25rem;
        }
        
        .kpi-subtext {
            font-size: 0.8rem;
            color: #6b72188;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .weekly-grid {
                grid-template-columns: 1fr;
            }
            
            .flow-visualization {
                flex-direction: column;
            }
            
            .flow-arrow {
                transform: rotate(90deg);
            }
            
            .campus-table {
                font-size: 0.8rem;
            }
            
            .campus-table th,
            .campus-table td {
                padding: 0.5rem;
            }
        }
        
        /* Campus Details Section */
        .campus-details-section {
            background: linear-gradient(to bottom, #ffffff, #f8f9fa);
            padding: 2.5rem 4rem;
            border-radius: 16px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            margin: 0 auto 2rem auto;
            border: 1px solid #e5e7eb;
            position: relative;
            overflow: hidden;
            width: 95%;
        }
        
        .campus-details-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #8b5cf6, #a78bfa, #c4b5fd);
        }
        
        .campus-details-title-container {
            text-align: center;
            margin-bottom: 2rem;
        }
        
        .section-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 0.5rem;
        }
        
        .campus-details-title-underline {
            width: 60px;
            height: 3px;
            background: linear-gradient(90deg, #8b5cf6, #a78bfa);
            margin: 0 auto;
            border-radius: 2px;
        }
        
        .campus-grid-layout {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 1.25rem;
            margin-bottom: 2rem;
        }
        
        .campus-detail-card {
            background: #f8f9fa;
            padding: 1.5rem;
            border-radius: 10px;
            border: 1px solid #e5e7eb;
            transition: all 0.2s ease;
        }
        
        .campus-detail-card:hover {
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            border-color: #d1d5db;
        }
        
        .campus-name {
            font-size: 1.125rem;
            font-weight: 600;
            margin-bottom: 1.25rem;
            color: #1f2937;
            padding-bottom: 0.75rem;
            border-bottom: 1px solid #e5e7eb;
        }
        
        .campus-metrics-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
        }
        
        .metric-group {
            display: flex;
            flex-direction: column;
        }
        
        .metric-group h4 {
            font-size: 0.75rem;
            font-weight: 600;
            color: #6b72188;
            margin-bottom: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        
        .current-value {
            font-size: 2.25rem;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 0.5rem;
            line-height: 1;
        }
        
        .registration-rate {
            font-size: 0.875rem;
            font-weight: 600;
            color: #10b981;
            margin-bottom: 0.5rem;
            display: inline-block;
            background: #d1fae5;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
        }
        
        .comparison-values {
            font-size: 0.8125rem;
            display: flex;
            flex-direction: column;
            gap: 0.375rem;
        }
        
        .comparison-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .comparison-item .year {
            color: #6b72188;
            min-width: 40px;
            font-size: 0.75rem;
        }
        
        .comparison-item .value {
            font-weight: 600;
            color: #374151;
            min-width: 45px;
        }
        
        .comparison-item .change {
            font-size: 0.75rem;
            font-weight: 600;
            padding: 0.125rem 0.375rem;
            border-radius: 3px;
        }
        
        .comparison-item .change.negative {
            color: #dc2626;
            background: #fee2e2;
        }
        
        .comparison-item .change.positive {
            color: #059669;
            background: #d1fae5;
        }
        
        .comparison-item .rate {
            font-weight: 600;
            color: #374151;
        }
        
        /* Summary Table */
        .campus-summary-table {
            margin-top: 2.5rem;
            overflow-x: auto;
        }
        
        .campus-summary-table h3 {
            font-size: 1.125rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: #1f2937;
        }
        
        .summary-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.875rem;
            min-width: 600px;
        }
        
        .summary-table th {
            background: #f3f4f6;
            padding: 0.875rem 0.75rem;
            text-align: left;
            font-weight: 600;
            color: #374151;
            border-bottom: 2px solid #e5e7eb;
            white-space: nowrap;
        }
        
        .summary-table th:nth-child(n+2) {
            text-align: right;
        }
        
        .summary-table td {
            padding: 0.75rem;
            border-bottom: 1px solid #e5e7eb;
        }
        
        .summary-table td:nth-child(n+2) {
            text-align: right;
        }
        
        .summary-table tr:hover {
            background: #f9fafb;
        }
        
        .summary-table .total-row {
            font-weight: 700;
            background: #f3f4f6;
            border-top: 2px solid #e5e7eb;
        }
        
        .summary-table .total-row td {
            padding: 0.875rem 0.75rem;
        }
        
        .summary-table .negative {
            color: #dc2626;
            font-weight: 600;
        }
        
        .summary-table .positive {
            color: #059669;
            font-weight: 600;
        }
        
        @media (max-width: 768px) {
            .campus-grid-layout {
                grid-template-columns: 1fr;
            }
            
            .campus-metrics-grid {
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }
            
            .campus-summary-table {
                margin-top: 2rem;
            }
        }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <!-- Header -->
        <div class="dashboard-header">
            <div class="header-content">
                <div class="header-title">
                    <h1>Executive Admissions Dashboard</h1>
                    <div class="header-subtitle">Fall 2025-2026 Admissions Cycle  Last updated: October 13, 2025</div>
                </div>
            </div>
        </div>
        
        <!-- Executive Summary -->
        <div class="executive-summary">
            <h2 class="summary-title">Executive Summary</h2>
            <div class="summary-grid">
                <!-- Applications Row -->
                <div class="summary-row-header">Applications</div>
                
                <div class="summary-card">
                    <div class="summary-content">
                        <div class="summary-label">Target Achievement</div>
                        <div class="summary-main">
                            <div class="summary-value negative" id="targetAchievement">74.4%</div>
                            <div class="summary-detail">
                                <span id="targetDetail">6,309 of 8,424 target</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="summary-card">
                    <div class="summary-content">
                        <div class="summary-label">Projected Total</div>
                        <div class="summary-main">
                            <div class="summary-value negative" id="projectedTotal">7,736</div>
                            <div class="summary-detail">
                                <span id="projectedDetail">688 below target</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="summary-card">
                    <div class="summary-content">
                        <div class="summary-label">YoY Performance</div>
                        <div class="summary-main">
                            <div class="summary-value negative" id="yoyPerformance">-4.3%</div>
                            <div class="summary-detail">
                                <span id="yoyDetail">vs 6,545 last year</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="summary-card">
                    <div class="summary-content">
                        <div class="summary-label">Required Daily Rate</div>
                        <div class="summary-main">
                            <div class="summary-value neutral" id="requiredRate">80</div>
                            <div class="summary-detail">
                                <span id="currentRate">Current: 54.5/day</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Registrations Row -->
                <div class="summary-row-header">Registrations</div>
                
                <div class="summary-card">
                    <div class="summary-content">
                        <div class="summary-label">Target Achievement</div>
                        <div class="summary-main">
                            <div class="summary-value positive" id="regTargetAchievement">75.5%</div>
                            <div class="summary-detail">
                                <span id="regTargetDetail">4,954 of 6,497 target</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="summary-card">
                    <div class="summary-content">
                        <div class="summary-label">Projected Total</div>
                        <div class="summary-main">
                            <div class="summary-value negative" id="regProjectedTotal">6,055</div>
                            <div class="summary-detail">
                                <span id="regProjectedDetail">442 below target</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="summary-card">
                    <div class="summary-content">
                        <div class="summary-label">YoY Performance</div>
                        <div class="summary-main">
                            <div class="summary-value positive" id="regYoyPerformance">+5.9%</div>
                            <div class="summary-detail">
                                <span id="regYoyDetail">vs 4,630 last year</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="summary-card">
                    <div class="summary-content">
                        <div class="summary-label">Required Daily Rate</div>
                        <div class="summary-main">
                            <div class="summary-value negative" id="regRequiredRate">59</div>
                            <div class="summary-detail">
                                <span id="regCurrentRate">Current: 42.6/day</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Cycle Progress Bar -->
        <div class="cycle-progress-section">
            <div class="cycle-header">
                <h2>Admission Cycle Progress</h2>
                <div class="cycle-stats">
                    <div class="cycle-stat">
                        <div class="cycle-stat-value">116</div>
                        <div class="cycle-stat-label">Current Day</div>
                    </div>
                    <div class="cycle-stat">
                        <div class="cycle-stat-value">86.3%</div>
                        <div class="cycle-stat-label">Complete<br><span style="font-size: 0.75rem; color: #9ca3af; font-weight: 500;">(120 of 139 days)</span></div>
                    </div>
                    <div class="cycle-stat">
                        <div class="cycle-stat-value">26</div>
                        <div class="cycle-stat-label">Days Remaining<br><span style="font-size: 0.75rem; color: #9ca3af; font-weight: 500;">(26 days)</span></div>
                    </div>
                    <div class="cycle-stat">
                        <div class="cycle-stat-value">142</div>
                        <div class="cycle-stat-label">Total Days</div>
                    </div>
                </div>
            </div>
            <div class="progress-visual">
                <div style="text-align: center; margin-bottom: 0.75rem; font-weight: 700; font-size: 1.125rem; color: #1f2937;">86.3% Complete</div>
                <div class="progress-bar-container">
                    <div class="progress-bar-fill" style="width: 86.3%">
                    </div>
                </div>
            </div>
            <div class="cycle-dates">
                <div class="cycle-date-item">
                    <span class="cycle-date-label">Start Date</span>
                    <span class="cycle-date-value">June 15</span>
                </div>
                <div class="cycle-date-item">
                    <span class="cycle-date-label">Current</span>
                    <span class="cycle-date-value">October 12 (Day 120)</span>
                </div>
                <div class="cycle-date-item">
                    <span class="cycle-date-label">End Date</span>
                    <span class="cycle-date-value">October 31</span>
                </div>
            </div>
        </div>
        
        <div class="section-divider"></div>
        
        <!-- What Changed Since Yesterday -->
        <div class="daily-changes-section">
            <div class="daily-changes-accent-bar"></div>
            <div class="daily-changes-content">
                <div class="daily-changes-title-container">
                    <h2 class="daily-changes-title">What Changed Since Yesterday</h2>
                    <div class="daily-changes-title-underline"></div>
                </div>
                <div class="changes-grid">
                    <div class="change-card">
                        <div class="change-card-accent-bar applications-accent"></div>
                        <div class="change-card-content">
                            <div class="change-header">
                                <span class="change-label">New Applications</span>
                                <span class="change-value neutral" id="dailyNewApps">0</span>
                            </div>
                            <div class="change-detail" id="dailyAppDetail">Total now: 6,309</div>
                            <div class="change-breakdown-section">
                                <div class="change-breakdown" id="campusBreakdown">Day 119  Day 120</div>
                            </div>
                        </div>
                    </div>
                    <div class="change-card">
                        <div class="change-card-accent-bar progress-accent"></div>
                        <div class="change-card-content">
                            <div class="change-header">
                                <span class="change-label">Total Progress</span>
                                <span class="change-value neutral" id="totalProgress">0%</span>
                            </div>
                            <div class="change-detail" id="progressDetail">6,309 to 6,309 applications</div>
                        </div>
                    </div>
                    <div class="change-card">
                        <div class="change-card-accent-bar registrations-accent"></div>
                        <div class="change-card-content">
                            <div class="change-header">
                                <span class="change-label">New Registrations</span>
                                <span class="change-value neutral" id="newRegistrations">0</span>
                            </div>
                            <div class="change-detail" id="registrationDetail">Total registered: 4,954</div>
                            <div class="change-breakdown-section">
                                <div class="change-breakdown" id="conversionRate">Conversion rate: 78.5%</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="section-divider"></div>
        
        <!-- Milestone Tracker -->
        <div class="milestone-section">
            <div class="milestone-title-container">
                <h2 class="milestone-title">Applications Milestone Progress</h2>
                <div class="milestone-title-underline"></div>
                <div style="text-align: center; margin-top: 1rem; font-size: 1.125rem; color: #4b5563;">
                    Current Applications: <span style="font-weight: 700; color: #1f2937; font-size: 1.25rem;">6,309</span>
                </div>
            </div>
            <div class="milestone-container">
                <div class="next-milestone-card">
                    <div class="milestone-header">
                        <span class="milestone-label">Next Milestone</span>
                        <span class="milestone-value" id="nextMilestoneValue">7,000</span>
                    </div>
                    <div class="milestone-detail">
                        <span id="milestoneDaysAway">19 days remaining</span>
                        <span class="milestone-separator"></span>
                        <span id="milestoneProjectedDate">78.1 apps/day needed</span>
                    </div>
                    <div style="text-align: center; margin-bottom: 0.5rem; font-weight: 600; font-size: 0.875rem; color: #ef4444;">686 to go</div>
                    <div class="milestone-progress-bar">
                        <div class="milestone-progress-fill" id="nextMilestoneProgress" style="width: 90.2%"></div>
                    </div>
                </div>
                <div class="all-milestones">
                    <div class="milestone-item achieved" data-target="1200">
                        <div class="milestone-item-header">
                            <span>1,200</span>
                            <span class="milestone-status achieved" id="milestone1200"> Achieved</span>
                        </div>
                    </div>
                    <div class="milestone-item achieved" data-target="1500">
                        <div class="milestone-item-header">
                            <span>1,500</span>
                            <span class="milestone-status achieved" id="milestone1500"> Achieved</span>
                        </div>
                    </div>
                    <div class="milestone-item achieved" data-target="2700">
                        <div class="milestone-item-header">
                            <span>2,700</span>
                            <span class="milestone-status achieved" id="milestone2700"> Achieved</span>
                        </div>
                    </div>
                    <div class="milestone-item achieved" data-target="5000">
                        <div class="milestone-item-header">
                            <span>5,000</span>
                            <span class="milestone-status achieved" id="milestone5000"> Achieved</span>
                        </div>
                    </div>
                    <div class="milestone-item final" data-target="8424">
                        <div class="milestone-item-header">
                            <span>8,424 </span>
                            <span class="milestone-status" id="milestone8424">Target</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="section-divider"></div>
        
        <!-- Application Historical Comparison -->
        <div class="historical-comparison-section">
            <h2 class="historical-title">Application Trends - Historical Comparison</h2>
            <div class="comparison-grid">
                <div class="comparison-stats">
                    <div class="stats-grid">
                        <div class="stat-item">
                            <div class="stat-label">Current Progress</div>
                            <div class="stat-value">4,954</div>
                            <div class="stat-detail">Day 120 of 139</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">Projected Total</div>
                            <div class="stat-value">7,736</div>
                            <div class="stat-detail">At current pace</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">vs 2024 Same Day</div>
                            <div class="stat-value text-negative">-4.3%</div>
                            <div class="stat-detail">vs 6,545</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">Cycle Complete</div>
                            <div class="stat-value">86.3%</div>
                            <div class="stat-detail">22 days left</div>
                        </div>
                    </div>
                </div>
                <div class="year-bars-container">
                    <div class="year-bar-item">
                        <div class="year-label">2025 Current</div>
                        <div class="year-bar-wrapper">
                            <div class="year-bar-bg">
                                <div class="year-bar-fill current-year" style="width: 74.4%;" id="apps-2025-bar">6,309 (projected: 7,736)
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="year-bar-item">
                        <div class="year-label">2024 Same Day</div>
                        <div class="year-bar-wrapper">
                            <div class="year-bar-bg">
                                <div class="year-bar-fill past-year-2024" style="width: 71.2%;">
                                    6,545
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="year-bar-item">
                        <div class="year-label">2023 Same Day</div>
                        <div class="year-bar-wrapper">
                            <div class="year-bar-bg">
                                <div class="year-bar-fill past-year-2023" style="width: 92.4%;">
                                    8,488
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="year-bar-item">
                        <div class="year-label">2019 Same Day</div>
                        <div class="year-bar-wrapper">
                            <div class="year-bar-bg">
                                <div class="year-bar-fill past-year-2019" style="width: 100%;">
                                    9,189 (Best)
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="section-divider"></div>
        
        <!-- Registration Historical Comparison -->
        <div class="historical-comparison-section">
            <h2 class="historical-title">Registration Trends - Historical Comparison</h2>
            <div class="comparison-grid">
                <div class="comparison-stats">
                    <div class="stats-grid">
                        <div class="stat-item">
                            <div class="stat-label">Current Progress</div>
                            <div class="stat-value">4,954</div>
                            <div class="stat-detail">Day 120 of 139</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">Projected Total</div>
                            <div class="stat-value">6,055</div>
                            <div class="stat-detail">At current pace</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">vs 2024 Same Day</div>
                            <div class="stat-value text-positive">+5.9%</div>
                            <div class="stat-detail">vs 4,630</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">Conversion Rate</div>
                            <div class="stat-value">78.3%</div>
                            <div class="stat-detail">Current</div>
                        </div>
                    </div>
                </div>
                <div class="year-bars-container">
                    <div class="year-bar-item">
                        <div class="year-label">2025 Current</div>
                        <div class="year-bar-wrapper">
                            <div class="year-bar-bg">
                                <div class="year-bar-fill current-year" style="width: 70.2%;" id="regs-2025-bar">4,954 (projected: 6,055)
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="year-bar-item">
                        <div class="year-label">2024 Same Day</div>
                        <div class="year-bar-wrapper">
                            <div class="year-bar-bg">
                                <div class="year-bar-fill past-year-2024" style="width: 66.2%;">
                                    4,630
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="year-bar-item">
                        <div class="year-label">2023 Same Day</div>
                        <div class="year-bar-wrapper">
                            <div class="year-bar-bg">
                                <div class="year-bar-fill past-year-2023" style="width: 88.1%;">
                                    6,161
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="year-bar-item">
                        <div class="year-label">2019 Same Day</div>
                        <div class="year-bar-wrapper">
                            <div class="year-bar-bg">
                                <div class="year-bar-fill past-year-2019" style="width: 100%;">
                                    6,989 (Best)
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="section-divider"></div>
        
        <!-- Registration Focus -->
        <div class="registration-focus-section">
            <div class="registration-title-container">
                <h2 class="registration-title">Registration Performance</h2>
                <div class="registration-title-underline"></div>
            </div>
            <div class="summary-grid">
                <div class="summary-card">
                    <div class="summary-label">Total Registered</div>
                    <div class="summary-value text-positive" id="totalRegistered">4,954</div>
                    <div class="summary-detail">Conversion Rate: 77.1%</div>
                </div>
                <div class="summary-card">
                    <div class="summary-label">vs Last Year</div>
                    <div class="summary-value text-positive">+202</div>
                    <div class="summary-detail">Strong progress in registrations</div>
                </div>
                <div class="summary-card">
                    <div class="summary-label">Registration Target</div>
                    <div class="summary-value positive">5,940</div>
                    <div class="summary-detail">5,853 still needed (1.5% achieved)</div>
                </div>
            </div>
        </div>
        
        <div class="section-divider"></div>
        
        <!-- Key Performance Indicators -->
        <div class="kpi-section">
            <div class="kpi-title-container">
                <h2 class="kpi-title">Key Performance Indicators</h2>
                <div class="kpi-title-underline"></div>
            </div>
            <div class="kpi-grid">
                <div class="kpi-card">
                    <div class="kpi-icon"></div>
                    <div class="kpi-content">
                        <div class="kpi-label">Weekly Momentum</div>
                        <div class="kpi-value" id="weeklyMomentum">+12.4%</div>
                        <div class="kpi-trend positive" id="weeklyTrend">Week 12: 150 vs Week 11: 155</div>
                    </div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-icon"></div>
                    <div class="kpi-content">
                        <div class="kpi-label">Conversion Quality</div>
                        <div class="kpi-value" id="conversionQuality">75.3%</div>
                        <div class="kpi-trend negative" id="conversionTrend">vs 70.7% last year</div>
                    </div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-icon"></div>
                    <div class="kpi-content">
                        <div class="kpi-label">Campus Health Score</div>
                        <div class="kpi-value" id="campusHealth">2/7</div>
                        <div class="kpi-trend negative" id="campusTrend">5 of 7 campuses underperforming vs last year</div>
                    </div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-icon"></div>
                    <div class="kpi-content">
                        <div class="kpi-label">Pace to Target</div>
                        <div class="kpi-value" id="paceToTarget">74.1%</div>
                        <div class="kpi-trend negative" id="paceTrend">2,186 applications below target pace</div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="section-divider"></div>
        
        <!-- Alerts Section -->
        <div class="alerts-section">
            <div class="alerts-title-container">
                <h2 class="alerts-title">Key Metrics & Insights</h2>
                <div class="alerts-title-underline"></div>
            </div>
            <div id="alertsContainer">
                <div class="alert-item">
                    <div class="alert-indicator info"></div>
                    <div class="alert-content">
                        <div class="alert-message">Registration rate decreased by 26.0 percentage points</div>
                        <div class="alert-detail">Current: 56.8% vs Last Year: 76.5%</div>
                    </div>
                </div>
                <div class="alert-item">
                    <div class="alert-indicator warning"></div>
                    <div class="alert-content">
                        <div class="alert-message">Projected shortfall of 465 applications</div>
                        <div class="alert-detail">Current trajectory: 7,959 vs Target: 8,424</div>
                    </div>
                </div>
                <div class="alert-item">
                    <div class="alert-indicator info"></div>
                    <div class="alert-content">
                        <div class="alert-message">3,944 additional registrations needed to match target</div>
                        <div class="alert-detail">Must achieve 74.4 registrations per business day for remaining 53 days</div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="section-divider"></div>
        
        <!-- Key Metrics Section -->
        <div class="metrics-section">
            <div class="metrics-title-container">
                <h2 class="metrics-title">Key Performance Metrics</h2>
                <div class="metrics-title-underline"></div>
            </div>
            <div class="metrics-header">
                <div class="view-toggle">
                    <button class="active" onclick="changeView('daily')">Daily</button>
                    <button onclick="changeView('weekly')">Weekly</button>
                    <button onclick="changeView('monthly')">Monthly</button>
                </div>
            </div>
            <div class="chart-container small">
                <canvas id="trendChart"></canvas>
            </div>
            <div class="chart-divider"></div>
            <div class="chart-container large">
                <canvas id="cumulativeChart"></canvas>
            </div>

        <div class="section-divider"></div>
        
        <!-- Campus Details Section -->
        <div class="campus-details-section">
            <div class="campus-details-title-container">
                <h2 class="section-title">Campus Details</h2>
                <div class="campus-details-title-underline"></div>
            </div>
            <div class="campus-grid-layout">
                <div class="campus-detail-card">
                    <h3 class="campus-name">Beirut</h3>
                    <div class="campus-metrics-grid">
                        <div class="metric-group">
                            <h4>Applications</h4>
                            <div class="current-value">2,272</div>
                            <div class="comparison-values">
                                <div class="comparison-item">
                                    <span class="year">2024:</span>
                                    <span class="value">2,630</span>
                                    <span class="change negative">-11.9%</span>
                                </div>
                                <div class="comparison-item">
                                    <span class="year">2023:</span>
                                    <span class="value">3,288</span>
                                    <span class="change negative">-29.6%</span>
                                </div>
                                <div class="comparison-item">
                                    <span class="year">2019:</span>
                                    <span class="value">4,131</span>
                                    <span class="change negative">-43.9%</span>
                                </div>
                            </div>
                        </div>
                        <div class="metric-group">
                            <h4>Registrations</h4>
                            <div class="current-value">1,701</div>
                            <div class="registration-rate">Rate: 71.9%</div>
                            <div class="comparison-values">
                                <div class="comparison-item">
                                    <span class="year">2024:</span>
                                    <span class="rate">66.5%</span>
                                </div>
                                <div class="comparison-item">
                                    <span class="year">2023:</span>
                                    <span class="rate">69.7%</span>
                                </div>
                                <div class="comparison-item">
                                    <span class="year">2019:</span>
                                    <span class="rate">69.4%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="campus-detail-card">
                    <h3 class="campus-name">Saida</h3>
                    <div class="campus-metrics-grid">
                        <div class="metric-group">
                            <h4>Applications</h4>
                            <div class="current-value">952</div>
                            <div class="comparison-values">
                                <div class="comparison-item">
                                    <span class="year">2024:</span>
                                    <span class="value">951</span>
                                    <span class="change negative">-1.9%</span>
                                </div>
                                <div class="comparison-item">
                                    <span class="year">2023:</span>
                                    <span class="value">1,134</span>
                                    <span class="change negative">-17.7%</span>
                                </div>
                                <div class="comparison-item">
                                    <span class="year">2019:</span>
                                    <span class="value">1,257</span>
                                    <span class="change negative">-25.8%</span>
                                </div>
                            </div>
                        </div>
                        <div class="metric-group">
                            <h4>Registrations</h4>
                            <div class="current-value">747</div>
                            <div class="registration-rate">Rate: 78.8%</div>
                            <div class="comparison-values">
                                <div class="comparison-item">
                                    <span class="year">2024:</span>
                                    <span class="rate">76.6%</span>
                                </div>
                                <div class="comparison-item">
                                    <span class="year">2023:</span>
                                    <span class="rate">76.8%</span>
                                </div>
                                <div class="comparison-item">
                                    <span class="year">2019:</span>
                                    <span class="rate">75.0%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="campus-detail-card">
                    <h3 class="campus-name">Mount Lebanon</h3>
                    <div class="campus-metrics-grid">
                        <div class="metric-group">
                            <h4>Applications</h4>
                            <div class="current-value">260</div>
                            <div class="comparison-values">
                                <div class="comparison-item">
                                    <span class="year">2024:</span>
                                    <span class="value">303</span>
                                    <span class="change negative">-15.5%</span>
                                </div>
                                <div class="comparison-item">
                                    <span class="year">2023:</span>
                                    <span class="value">385</span>
                                    <span class="change negative">-33.5%</span>
                                </div>
                                <div class="comparison-item">
                                    <span class="year">2019:</span>
                                    <span class="value">480</span>
                                    <span class="change negative">-46.7%</span>
                                </div>
                            </div>
                        </div>
                        <div class="metric-group">
                            <h4>Registrations</h4>
                            <div class="current-value">217</div>
                            <div class="registration-rate">Rate: 84.0%</div>
                            <div class="comparison-values">
                                <div class="comparison-item">
                                    <span class="year">2024:</span>
                                    <span class="rate">79.9%</span>
                                </div>
                                <div class="comparison-item">
                                    <span class="year">2023:</span>
                                    <span class="rate">74.5%</span>
                                </div>
                                <div class="comparison-item">
                                    <span class="year">2019:</span>
                                    <span class="rate">74.0%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="campus-detail-card">
                    <h3 class="campus-name">Nabatieh</h3>
                    <div class="campus-metrics-grid">
                        <div class="metric-group">
                            <h4>Applications</h4>
                            <div class="current-value">664</div>
                            <div class="comparison-values">
                                <div class="comparison-item">
                                    <span class="year">2024:</span>
                                    <span class="value">520</span>
                                    <span class="change positive">+26.5%</span>
                                </div>
                                <div class="comparison-item">
                                    <span class="year">2023:</span>
                                    <span class="value">825</span>
                                    <span class="change negative">-20.2%</span>
                                </div>
                                <div class="comparison-item">
                                    <span class="year">2019:</span>
                                    <span class="value">655</span>
                                    <span class="change positive">+0.5%</span>
                                </div>
                            </div>
                        </div>
                        <div class="metric-group">
                            <h4>Registrations</h4>
                            <div class="current-value">557</div>
                            <div class="registration-rate">Rate: 83.1%</div>
                            <div class="comparison-values">
                                <div class="comparison-item">
                                    <span class="year">2024:</span>
                                    <span class="rate">65.0%</span>
                                </div>
                                <div class="comparison-item">
                                    <span class="year">2023:</span>
                                    <span class="rate">75.0%</span>
                                </div>
                                <div class="comparison-item">
                                    <span class="year">2019:</span>
                                    <span class="rate">85.2%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="campus-detail-card">
                    <h3 class="campus-name">Tripoli</h3>
                    <div class="campus-metrics-grid">
                        <div class="metric-group">
                            <h4>Applications</h4>
                            <div class="current-value">914</div>
                            <div class="comparison-values">
                                <div class="comparison-item">
                                    <span class="year">2024:</span>
                                    <span class="value">958</span>
                                    <span class="change negative">-6.9%</span>
                                </div>
                                <div class="comparison-item">
                                    <span class="year">2023:</span>
                                    <span class="value">1,431</span>
                                    <span class="change negative">-37.7%</span>
                                </div>
                                <div class="comparison-item">
                                    <span class="year">2019:</span>
                                    <span class="value">1,200</span>
                                    <span class="change negative">-25.7%</span>
                                </div>
                            </div>
                        </div>
                        <div class="metric-group">
                            <h4>Registrations</h4>
                            <div class="current-value">666</div>
                            <div class="registration-rate">Rate: 71.7%</div>
                            <div class="comparison-values">
                                <div class="comparison-item">
                                    <span class="year">2024:</span>
                                    <span class="rate">73.4%</span>
                                </div>
                                <div class="comparison-item">
                                    <span class="year">2023:</span>
                                    <span class="rate">67.7%</span>
                                </div>
                                <div class="comparison-item">
                                    <span class="year">2019:</span>
                                    <span class="rate">80.5%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="campus-detail-card">
                    <h3 class="campus-name">Tyre</h3>
                    <div class="campus-metrics-grid">
                        <div class="metric-group">
                            <h4>Applications</h4>
                            <div class="current-value">935</div>
                            <div class="comparison-values">
                                <div class="comparison-item">
                                    <span class="year">2024:</span>
                                    <span class="value">844</span>
                                    <span class="change positive">+8.8%</span>
                                </div>
                                <div class="comparison-item">
                                    <span class="year">2023:</span>
                                    <span class="value">1,002</span>
                                    <span class="change negative">-8.4%</span>
                                </div>
                                <div class="comparison-item">
                                    <span class="year">2019:</span>
                                    <span class="value">920</span>
                                    <span class="change negative">-0.2%</span>
                                </div>
                            </div>
                        </div>
                        <div class="metric-group">
                            <h4>Registrations</h4>
                            <div class="current-value">801</div>
                            <div class="registration-rate">Rate: 85.1%</div>
                            <div class="comparison-values">
                                <div class="comparison-item">
                                    <span class="year">2024:</span>
                                    <span class="rate">69.9%</span>
                                </div>
                                <div class="comparison-item">
                                    <span class="year">2023:</span>
                                    <span class="rate">81.8%</span>
                                </div>
                                <div class="comparison-item">
                                    <span class="year">2019:</span>
                                    <span class="rate">87.8%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="campus-detail-card">
                    <h3 class="campus-name">Akkar</h3>
                    <div class="campus-metrics-grid">
                        <div class="metric-group">
                            <h4>Applications</h4>
                            <div class="current-value">312</div>
                            <div class="comparison-values">
                                <div class="comparison-item">
                                    <span class="year">2024:</span>
                                    <span class="value">339</span>
                                    <span class="change negative">-12.4%</span>
                                </div>
                                <div class="comparison-item">
                                    <span class="year">2023:</span>
                                    <span class="value">406</span>
                                    <span class="change negative">-26.8%</span>
                                </div>
                                <div class="comparison-item">
                                    <span class="year">2019:</span>
                                    <span class="value">543</span>
                                    <span class="change negative">-45.3%</span>
                                </div>
                            </div>
                        </div>
                        <div class="metric-group">
                            <h4>Registrations</h4>
                            <div class="current-value">265</div>
                            <div class="registration-rate">Rate: 83.9%</div>
                            <div class="comparison-values">
                                <div class="comparison-item">
                                    <span class="year">2024:</span>
                                    <span class="rate">82.9%</span>
                                </div>
                                <div class="comparison-item">
                                    <span class="year">2023:</span>
                                    <span class="rate">73.9%</span>
                                </div>
                                <div class="comparison-item">
                                    <span class="year">2019:</span>
                                    <span class="rate">90.6%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            

            <!-- Summary Table -->
            <div class="campus-summary-table">
                <h3>Summary by Campus</h3>
                <table class="summary-table">
                    <thead>
                        <tr>
                            <th>Campus</th>
                            <th>2025 Apps</th>
                            <th>2025 Reg</th>
                            <th>Conv Rate</th>
                            <th>% of Total Apps</th>
                        </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td>Beirut</td>
                        <td>2,272</td>
                        <td>1,701</td>
                        <td>75.2%</td>
                        <td>36.0%</td>
                    </tr>
                    <tr>
                        <td>Saida</td>
                        <td>952</td>
                        <td>747</td>
                        <td>78.6%</td>
                        <td>15.1%</td>
                    </tr>
                    <tr>
                        <td>Mount Lebanon</td>
                        <td>260</td>
                        <td>217</td>
                        <td>83.8%</td>
                        <td>4.1%</td>
                    </tr>
                    <tr>
                        <td>Nabatieh</td>
                        <td>664</td>
                        <td>557</td>
                        <td>83.9%</td>
                        <td>10.6%</td>
                    </tr>
                    <tr>
                        <td>Tyre</td>
                        <td>935</td>
                        <td>801</td>
                        <td>85.6%</td>
                        <td>14.9%</td>
                    </tr>
                    <tr>
                        <td>Akkar</td>
                        <td>312</td>
                        <td>265</td>
                        <td>84.6%</td>
                        <td>4.9%</td>
                    </tr>
                    <tr>
                        <td>Tripoli</td>
                        <td>914</td>
                        <td>666</td>
                        <td>72.2%</td>
                        <td>14.4%</td>
                    </tr>
                    <tr class="total-row">
                        <td><strong>Total</strong></td>
                        <td><strong>6,309</strong></td>
                        <td><strong>4,954</strong></td>
                        <td><strong>78.6%</strong></td>
                        <td><strong>100.0%</strong></td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="section-divider"></div>

        <!-- Historical Registration Comparison -->
        <div class="historical-comparison-section">
            <h2 class="historical-title">Registration Conversion Rates by Campus (Day 120)</h2>
            
            <!-- 2025 Current Conversion Rates Table -->
            <div style="background: white; padding: 1.5rem; border-radius: 12px; border: 1px solid #e5e7eb; margin-bottom: 2rem;">
                <h3 style="font-size: 1.25rem; font-weight: 600; color: #1f2937; margin-bottom: 1.5rem;">2025 Current Conversion Rates (Ranked by Performance)</h3>
                <div style="overflow-x: auto;">
                    <table style="width: 100%; border-collapse: collapse; font-size: 0.9rem;">
                        <thead>
                            <tr style="background: #f3f4f6;">
                                <th style="padding: 0.75rem; text-align: left; font-weight: 600; color: #374151; border-bottom: 2px solid #e5e7eb;">Rank</th>
                                <th style="padding: 0.75rem; text-align: left; font-weight: 600; color: #374151; border-bottom: 2px solid #e5e7eb;">Campus</th>
                                <th style="padding: 0.75rem; text-align: center; font-weight: 600; color: #374151; border-bottom: 2px solid #e5e7eb;">2025 Rate</th>
                                <th style="padding: 0.75rem; text-align: center; font-weight: 600; color: #374151; border-bottom: 2px solid #e5e7eb;">Applications</th>
                                <th style="padding: 0.75rem; text-align: center; font-weight: 600; color: #374151; border-bottom: 2px solid #e5e7eb;">Registrations</th>
                            </tr>
                        </thead>
                        <tbody>
                        <tr>
                            <td style="padding: 12px; text-align: center; font-weight: 600;">#1</td>
                            <td style="padding: 12px; text-align: left;">Tyre</td>
                            <td style="padding: 12px; text-align: center; font-weight: 600; color: #059669;">85.7%</td>
                            <td style="padding: 12px; text-align: center;">935</td>
                            <td style="padding: 12px; text-align: center;">801</td>
                        </tr>
                        <tr>
                            <td style="padding: 12px; text-align: center; font-weight: 600;">#2</td>
                            <td style="padding: 12px; text-align: left;">Mount Lebanon</td>
                            <td style="padding: 12px; text-align: center; font-weight: 600; color: #059669;">83.5%</td>
                            <td style="padding: 12px; text-align: center;">260</td>
                            <td style="padding: 12px; text-align: center;">217</td>
                        </tr>
                        <tr>
                            <td style="padding: 12px; text-align: center; font-weight: 600;">#3</td>
                            <td style="padding: 12px; text-align: left;">Nabatieh</td>
                            <td style="padding: 12px; text-align: center; font-weight: 600; color: #059669;">83.9%</td>
                            <td style="padding: 12px; text-align: center;">664</td>
                            <td style="padding: 12px; text-align: center;">557</td>
                        </tr>
                        <tr>
                            <td style="padding: 12px; text-align: center; font-weight: 600;">#4</td>
                            <td style="padding: 12px; text-align: left;">Akkar</td>
                            <td style="padding: 12px; text-align: center; font-weight: 600; color: #059669;">84.9%</td>
                            <td style="padding: 12px; text-align: center;">312</td>
                            <td style="padding: 12px; text-align: center;">265</td>
                        </tr>
                        <tr>
                            <td style="padding: 12px; text-align: center; font-weight: 600;">#5</td>
                            <td style="padding: 12px; text-align: left;">Saida</td>
                            <td style="padding: 12px; text-align: center; font-weight: 600; color: #059669;">78.5%</td>
                            <td style="padding: 12px; text-align: center;">952</td>
                            <td style="padding: 12px; text-align: center;">747</td>
                        </tr>
                        <tr>
                            <td style="padding: 12px; text-align: center; font-weight: 600;">#6</td>
                            <td style="padding: 12px; text-align: left;">Beirut</td>
                            <td style="padding: 12px; text-align: center; font-weight: 600; color: #d97706;">74.9%</td>
                            <td style="padding: 12px; text-align: center;">2,272</td>
                            <td style="padding: 12px; text-align: center;">1,701</td>
                        </tr>
                        <tr>
                            <td style="padding: 12px; text-align: center; font-weight: 600;">#7</td>
                            <td style="padding: 12px; text-align: left;">Tripoli</td>
                            <td style="padding: 12px; text-align: center; font-weight: 600; color: #d97706;">72.9%</td>
                            <td style="padding: 12px; text-align: center;">914</td>
                            <td style="padding: 12px; text-align: center;">666</td>
                        </tr>
                        <tr style="background: #f3f4f6; font-weight: 700;">
                            <td style="padding: 12px; text-align: center;">-</td>
                            <td style="padding: 12px; text-align: left;">OVERALL</td>
                            <td style="padding: 12px; text-align: center; color: #059669;">78.5%</td>
                            <td style="padding: 12px; text-align: center;">6,309</td>
                            <td style="padding: 12px; text-align: center;">4,954</td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Daily data for charts (Day 1 through Day 120)
        // Cumulative data from Excel files
        const dailyData2025 = [38, 44, 52, 64, 71, 76, 77, 78, 93, 108, 117, 118, 122, 122, 123, 135, 149, 171, 182, 186, 188, 190, 191, 204, 218, 224, 231, 234, 237, 258, 279, 322, 368, 405, 406, 410, 480, 562, 623, 707, 739, 744, 749, 848, 903, 963, 1022, 1047, 1066, 1084, 1172, 1365, 1535, 1686, 1740, 1752, 1770, 1945, 2136, 2269, 2416, 2437, 2450, 2459, 2628, 2801, 2943, 3071, 3108, 3117, 3135, 3304, 3457, 3581, 3700, 3725, 3729, 3741, 3898, 4053, 4189, 4204, 4245, 4257, 4266, 4479, 4629, 4755, 4885, 4934, 4940, 4947, 5129, 5267, 5365, 5468, 5534, 5537, 5545, 5663, 5756, 5855, 5932, 5966, 5967, 5975, 6046, 6101, 6143, 6184, 6208, 6208, 6211, 6254, 6293, 6267, 6293, 6308, 6309, 6309];

        const dailyData2024 = [56, 58, 58, 59, 61, 62, 70, 74, 75, 76, 88, 97, 105, 115, 123, 124, 127, 140, 158, 164, 196, 217, 221, 227, 233, 301, 362, 415, 434, 444, 448, 520, 572, 577, 656, 694, 698, 704, 796, 876, 949, 1007, 1029, 1032, 1048, 1209, 1383, 1517, 1686, 1726, 1735, 1745, 1950, 2138, 2291, 2474, 2510, 2519, 2531, 2727, 2971, 3144, 3154, 3197, 3201, 3209, 3457, 3657, 3808, 3946, 3971, 3973, 3986, 4151, 4295, 4420, 4548, 4568, 4571, 4577, 4811, 4983, 5124, 5278, 5326, 5343, 5353, 5568, 5719, 5858, 5987, 6019, 6022, 6024, 6033, 6214, 6217, 6358, 6385, 6392, 6395, 6488, 6505, 6523, 6533, 6539, 6539, 6539, 6540, 6540, 6543, 6544, 6545, 6545, 6549];

        const dailyData2023 = [387, 413, 426, 430, 438, 460, 475, 494, 507, 511, 515, 521, 538, 546, 548, 550, 557, 561, 568, 591, 620, 651, 668, 674, 680, 686, 706, 716, 737, 755, 769, 787, 798, 882, 963, 990, 1063, 1100, 1112, 1124, 1211, 1278, 1344, 1413, 1437, 1451, 1462, 1545, 1590, 1666, 1770, 1803, 1827, 1856, 2082, 2329, 2525, 2724, 2791, 2811, 2825, 3096, 3133, 3393, 3614, 3701, 3712, 3738, 4022, 4230, 4415, 4587, 4687, 4762, 4784, 5004, 5210, 5355, 5477, 5525, 5539, 5547, 5747, 5934, 6081, 6224, 6271, 6281, 6292, 6476, 6650, 6782, 6900, 6938, 6945, 6957, 7171, 7308, 7415, 7528, 7562, 7571, 7582, 7752, 7870, 7889, 8037, 8083, 8089, 8095, 8225, 8310, 8389, 8471, 8488];
        const dailyData2019 = [197, 197, 198, 209, 220, 231, 240, 247, 247, 252, 266, 273, 296, 323, 350, 353, 355, 390, 426, 456, 482, 499, 499, 501, 550, 592, 648, 739, 781, 785, 789, 912, 1016, 1084, 1145, 1201, 1208, 1213, 1347, 1452, 1525, 1629, 1670, 1673, 1680, 1812, 1961, 2202, 2267, 2302, 2305, 2307, 2406, 2562, 2635, 2700, 2753, 2757, 2759, 2765, 2767, 2774, 2778, 3023, 3025, 3026, 3212, 3392, 3631, 3778, 3861, 3864, 3865, 3977, 4156, 4336, 4461, 4560, 4564, 4564, 4571, 4852, 5113, 5277, 5385, 5387, 5392, 5602, 5604, 5882, 6019, 6148, 6150, 6152, 6377, 6573, 6791, 7029, 7170, 7173, 7176, 7506, 7710, 7886, 8265, 8481, 8504, 8509, 8662, 8759, 8875, 9072, 9185, 9186, 9189];

        const dayLabels = Array.from({length: 120}, (_, i) => i + 1);

        let currentView = 'daily';
        let trendChart, cumulativeChart;

        function changeView(view) {
            currentView = view;
            document.querySelectorAll('.view-toggle button').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');

            updateCharts();
        }

        function aggregateData(data, period) {
            if (period === 'daily') return data;

            const result = [];
            const groupSize = period === 'weekly' ? 7 : 30;

            for (let i = 0; i < data.length; i += groupSize) {
                const chunk = data.slice(Math.max(0, i - groupSize + 1), i + 1);
                result.push(chunk[chunk.length - 1]);
            }

            return result;
        }

        function updateCharts() {
            const data2025 = currentView === 'daily' ? dailyData2025 : aggregateData(dailyData2025, currentView);
            const data2024 = currentView === 'daily' ? dailyData2024 : aggregateData(dailyData2024, currentView);
            const labels = currentView === 'daily' ? dayLabels :
                          Array.from({length: data2025.length}, (_, i) => i + 1);

            // Update trend chart (daily new applications)
            const dailyNew2025 = [data2025[0]];
            for (let i = 1; i < data2025.length; i++) {
                dailyNew2025.push(data2025[i] - data2025[i-1]);
            }

            if (trendChart) trendChart.destroy();

            const ctx1 = document.getElementById('trendChart').getContext('2d');
            trendChart = new Chart(ctx1, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: '2025 Daily Applications',
                        data: dailyNew2025,
                        borderColor: '#3b82f6',
                        backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Daily Application Trend (Day 120)',
                            font: { size: 16, weight: 'bold' }
                        },
                        legend: { display: true }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: { display: true, text: 'Applications' }
                        },
                        x: {
                            title: { display: true, text: 'Day of Cycle' }
                        }
                    }
                }
            });

            // Update cumulative chart
            if (cumulativeChart) cumulativeChart.destroy();

            const ctx2 = document.getElementById('cumulativeChart').getContext('2d');
            cumulativeChart = new Chart(ctx2, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: '2025',
                            data: data2025,
                            borderColor: '#3b82f6',
                            backgroundColor: 'rgba(59, 130, 246, 0.1)',
                            tension: 0.4,
                            fill: false,
                            borderWidth: 3
                        },
                        {
                            label: '2024',
                            data: data2024,
                            borderColor: '#94a3b8',
                            backgroundColor: 'rgba(148, 163, 184, 0.1)',
                            tension: 0.4,
                            fill: false,
                            borderWidth: 2,
                            borderDash: [5, 5]
                        },
                        {
                            label: '2023',
                            data: dailyData2023,
                            borderColor: '#10b981',
                            backgroundColor: 'rgba(16, 185, 129, 0.1)',
                            tension: 0.4,
                            fill: false,
                            borderWidth: 2,
                            borderDash: [3, 3]
                        },
                        {
                            label: '2019',
                            data: dailyData2019,
                            borderColor: '#f59e0b',
                            backgroundColor: 'rgba(245, 158, 11, 0.1)',
                            tension: 0.4,
                            fill: false,
                            borderWidth: 2,
                            borderDash: [1, 3]
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Cumulative Applications Comparison (Day 120)',
                            font: { size: 16, weight: 'bold' }
                        },
                        legend: { display: true }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: { display: true, text: 'Total Applications' }
                        },
                        x: {
                            title: { display: true, text: 'Day of Cycle' }
                        }
                    },
                    interaction: {
                        intersect: false,
                        mode: 'index'
                    }
                }
            });
        }

        // Initialize charts when page loads
        document.addEventListener('DOMContentLoaded', function() {
            updateCharts();
        });
    </script>

</body>
</html>


